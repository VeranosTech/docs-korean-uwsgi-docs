

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ko" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ko" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>uWSGI internal routing &mdash; uWSGI 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="The uWSGI Legion subsystem" href="Legion.html" />
    <link rel="prev" title="The uWSGI FastRouter" href="Fastrouter.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> uWSGI
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="WSGIquickstart.html">Quickstart for Python/WSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSGIquickstart.html">Quickstart for perl/PSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RackQuickstart.html">Quickstart for ruby/Rack applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Snippets.html">Snippets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Download.html">Getting uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildSystem.html">The uWSGI build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Management.html">Managing the uWSGI server</a></li>
<li class="toctree-l1"><a class="reference internal" href="LanguagesAndPlatforms.html">Supported languages and platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupportedPlatforms.html">Supported Platforms/Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServers.html">Web server integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThingsToKnow.html">Things to know (best practices and &quot;issues&quot;) READ IT !!!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuring uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="FallbackConfig.html">Fallback configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConfigLogic.html">Configuration logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">uWSGI Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="CustomOptions.html">Defining new options for your instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParsingOrder.html">How uWSGI parses config files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vars.html">uwsgi protocol magic variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protocol.html">The uwsgi Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="AttachingDaemons.html">Managing external daemons/services</a></li>
<li class="toctree-l1"><a class="reference internal" href="MasterFIFO.html">The Master FIFO</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inetd.html">Socket activation with inetd/xinetd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Upstart.html">Running uWSGI via Upstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Systemd.html">Systemd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Circus.html">Running uWSGI instances with Circus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Embed.html">Embedding an application in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogFormat.html">Formatting uWSGI requests logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogEncoders.html">Log encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkerOverride.html">Overriding Workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThirdPartyPlugins.html">uWSGI third party plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/CachingCookbook.html">The uWSGI Caching Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/Django_and_nginx.html">Setting up Django and your web server with uWSGI and nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/dreamhost.html">Running uWSGI on Dreamhost shared hosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_python.html">Running python webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_ruby.html">Running Ruby/Rack webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ReliableFuse.html">Reliably use FUSE filesystems for uWSGI vassals (with Linux)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/DynamicProxying.html">Build a dynamic proxy using RPC and internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/GraphiteAndMetrics.html">Setting up Graphite on Ubuntu using the Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="articles/SerializingAccept.html">Serializing accept(), AKA Thundering Herd, AKA the Zeeg Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/TheArtOfGracefulReloading.html">The Art of Graceful Reloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/FunWithPerlEyetoyRaspberrypi.html">Fun with Perl, Eyetoy and RaspberryPi</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/OffloadingWebsocketsAndSSE.html">Offloading Websockets and Server-Sent Events AKA &quot;Combine them with Django safely&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/WSGIEnvBehaviour.html">WSGI env behaviour policies</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="AlarmSubsystem.html">The uWSGI alarm subsystem (from 1.3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Caching.html">The uWSGI caching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebCaching.html">WebCaching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cron.html">The uWSGI cron-like interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fastrouter.html">The uWSGI FastRouter</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">uWSGI internal routing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-routing-chains">The routing chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-internal-routing-table">The internal routing table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#action-return-values">Action return values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-first-example">The first example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-request-vars">Accessing request vars</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-cookies">Accessing cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-query-string-items">Accessing query string items</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pluggable-routing-variables">Pluggable routing variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#is-route-if-not-enough-why-route-uri-and-friends">Is --route-if not enough? Why --route-uri and friends?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#goto">GOTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#collecting-response-headers">Collecting response headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-available-actions">The available actions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#continue-last"><code class="docutils literal notranslate"><span class="pre">continue</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#break"><code class="docutils literal notranslate"><span class="pre">break</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#return-break-with-status"><code class="docutils literal notranslate"><span class="pre">return</span></code>/<code class="docutils literal notranslate"><span class="pre">break-with-status</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#log"><code class="docutils literal notranslate"><span class="pre">log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#logvar"><code class="docutils literal notranslate"><span class="pre">logvar</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">goto</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#addvar"><code class="docutils literal notranslate"><span class="pre">addvar</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#addheader"><code class="docutils literal notranslate"><span class="pre">addheader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#delheader-remheader"><code class="docutils literal notranslate"><span class="pre">delheader</span></code>//<code class="docutils literal notranslate"><span class="pre">remheader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#signal"><code class="docutils literal notranslate"><span class="pre">signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#send"><code class="docutils literal notranslate"><span class="pre">send</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#send-crnl"><code class="docutils literal notranslate"><span class="pre">send-crnl</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redirect-redirect-302"><code class="docutils literal notranslate"><span class="pre">redirect</span></code>/<code class="docutils literal notranslate"><span class="pre">redirect-302</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redirect-permanent-redirect-301"><code class="docutils literal notranslate"><span class="pre">redirect-permanent</span></code>/<code class="docutils literal notranslate"><span class="pre">redirect-301</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewrite"><code class="docutils literal notranslate"><span class="pre">rewrite</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewrite-last"><code class="docutils literal notranslate"><span class="pre">rewrite-last</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#uwsgi"><code class="docutils literal notranslate"><span class="pre">uwsgi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#http"><code class="docutils literal notranslate"><span class="pre">http</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#static"><code class="docutils literal notranslate"><span class="pre">static</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#basicauth"><code class="docutils literal notranslate"><span class="pre">basicauth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#basicauth-next"><code class="docutils literal notranslate"><span class="pre">basicauth-next</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldapauth"><code class="docutils literal notranslate"><span class="pre">ldapauth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ldapauth-next"><code class="docutils literal notranslate"><span class="pre">ldapauth-next</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache"><code class="docutils literal notranslate"><span class="pre">cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cachestore-cache-store"><code class="docutils literal notranslate"><span class="pre">cachestore</span></code>/<code class="docutils literal notranslate"><span class="pre">cache-store</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cachevar"><code class="docutils literal notranslate"><span class="pre">cachevar</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cacheset"><code class="docutils literal notranslate"><span class="pre">cacheset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#memcached"><code class="docutils literal notranslate"><span class="pre">memcached</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rpc"><code class="docutils literal notranslate"><span class="pre">rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#call"><code class="docutils literal notranslate"><span class="pre">call</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rpcret"><code class="docutils literal notranslate"><span class="pre">rpcret</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rpcblob-rpcnext"><code class="docutils literal notranslate"><span class="pre">rpcblob</span></code>//<code class="docutils literal notranslate"><span class="pre">rpcnext</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rpcraw"><code class="docutils literal notranslate"><span class="pre">rpcraw</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rpcvar"><code class="docutils literal notranslate"><span class="pre">rpcvar</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#access"><code class="docutils literal notranslate"><span class="pre">access</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#spnego"><code class="docutils literal notranslate"><span class="pre">spnego</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#radius"><code class="docutils literal notranslate"><span class="pre">radius</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#xslt"><code class="docutils literal notranslate"><span class="pre">xslt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ssi">ssi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gridfs">gridfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#donotlog"><code class="docutils literal notranslate"><span class="pre">donotlog</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#chdir"><code class="docutils literal notranslate"><span class="pre">chdir</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#seturi"><code class="docutils literal notranslate"><span class="pre">seturi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#setapp"><code class="docutils literal notranslate"><span class="pre">setapp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#setuser"><code class="docutils literal notranslate"><span class="pre">setuser</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#sethome"><code class="docutils literal notranslate"><span class="pre">sethome</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#setfile"><code class="docutils literal notranslate"><span class="pre">setfile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#setscriptname"><code class="docutils literal notranslate"><span class="pre">setscriptname</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#setprocname"><code class="docutils literal notranslate"><span class="pre">setprocname</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#alarm"><code class="docutils literal notranslate"><span class="pre">alarm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#flush"><code class="docutils literal notranslate"><span class="pre">flush</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fixcl"><code class="docutils literal notranslate"><span class="pre">fixcl</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cgi"><code class="docutils literal notranslate"><span class="pre">cgi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cgihelper"><code class="docutils literal notranslate"><span class="pre">cgihelper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">access</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache-continue"><code class="docutils literal notranslate"><span class="pre">cache-continue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">cachevar</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cacheinc"><code class="docutils literal notranslate"><span class="pre">cacheinc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cachedec"><code class="docutils literal notranslate"><span class="pre">cachedec</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cachemul"><code class="docutils literal notranslate"><span class="pre">cachemul</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cachediv"><code class="docutils literal notranslate"><span class="pre">cachediv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proxyhttp"><code class="docutils literal notranslate"><span class="pre">proxyhttp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">memcached</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#memcached-continue"><code class="docutils literal notranslate"><span class="pre">memcached-continue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#memcachedstore"><code class="docutils literal notranslate"><span class="pre">memcachedstore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#memcached-store"><code class="docutils literal notranslate"><span class="pre">memcached-store</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redis"><code class="docutils literal notranslate"><span class="pre">redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redis-continue"><code class="docutils literal notranslate"><span class="pre">redis-continue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redisstore"><code class="docutils literal notranslate"><span class="pre">redisstore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#redis-store"><code class="docutils literal notranslate"><span class="pre">redis-store</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proxyuwsgi"><code class="docutils literal notranslate"><span class="pre">proxyuwsgi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#harakiri"><code class="docutils literal notranslate"><span class="pre">harakiri</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#clearheaders"><code class="docutils literal notranslate"><span class="pre">clearheaders</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#resetheaders"><code class="docutils literal notranslate"><span class="pre">resetheaders</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#xattr"><code class="docutils literal notranslate"><span class="pre">xattr</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Legion.html">The uWSGI Legion subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Locks.html">Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mules.html">uWSGI Mules</a></li>
<li class="toctree-l1"><a class="reference internal" href="OffloadSubsystem.html">The uWSGI offloading subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Queue.html">The uWSGI queue framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="RPC.html">uWSGI RPC Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="SharedArea.html">SharedArea -- share memory pages between uWSGI components</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signals.html">The uWSGI Signal Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spooler.html">The uWSGI Spooler</a></li>
<li class="toctree-l1"><a class="reference internal" href="SubscriptionServer.html">uWSGI Subscription Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="StaticFiles.html">Serving static files with uWSGI (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNI.html">SNI - Server Name Identification (virtual hosting for SSL nodes)</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeoIP.html">The GeoIP plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transformations.html">uWSGI Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebSockets.html">WebSocket support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chunked.html">The Chunked input API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Cheaper.html">The uWSGI cheaper subsystem -- adaptive process spawning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Emperor.html">The uWSGI Emperor -- multi-app deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Broodlord.html">Auto-scaling with Broodlord mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zerg.html">Zerg mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicApps.html">Adding applications dynamically</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSLScaling.html">Scaling SSL connections (uWSGI 1.9)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Capabilities.html">Setting POSIX Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cgroups.html">Running uWSGI in a Linux CGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="KSM.html">Using Linux KSM in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html">Jailing your apps using Linux Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html#the-old-way-the-namespace-option">The old way: the --namespace option</a></li>
<li class="toctree-l1"><a class="reference internal" href="FreeBSDJails.html">FreeBSD Jails</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForkptyRouter.html">The Forkpty Router</a></li>
<li class="toctree-l1"><a class="reference internal" href="TunTapRouter.html">The TunTap Router</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nagios.html">Monitoring uWSGI with Nagios</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNMP.html">The embedded SNMP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="PushingStats.html">Pushing statistics (from 1.4)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carbon.html">Integration with Graphite/Carbon</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatsServer.html">The uWSGI Stats Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Async.html">uWSGI asynchronous/non-blocking modes (updated to uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gevent.html">The Gevent loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tornado.html">The Tornado loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="uGreen.html">uGreen -- uWSGI Green Threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncio.html">The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Apache.html">Apache support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cherokee.html">Cherokee support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTP.html">Native HTTP support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTPS.html">HTTPS 지원 (1.3 버전부터)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPDY.html">The SPDY router (uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lighttpd.html">Lighttpd support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mongrel2.html">Attaching uWSGI to Mongrel2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nginx.html">Nginx support</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html">Using OpenBSD httpd as proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html#notes">Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python support</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyPy.html">The PyPy plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="PHP.html">Running PHP scripts in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Perl.html">uWSGI Perl support (PSGI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ruby.html">Ruby support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lua.html">Using Lua/WSAPI with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="JVM.html">JVM in the uWSGI server (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mono.html">The Mono ASP.NET plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="CGI.html">Running CGI scripts on uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCCGO.html">The GCCGO plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Symcall.html">The Symcall plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLT.html">The XSLT plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSI.html">SSI (Server Side Includes) plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="V8.html">uWSGI V8 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="GridFS.html">The GridFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="GlusterFS.html">The GlusterFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Rados.html">The RADOS plugin</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Pty.html">The Pty plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPNEGO.html">SPNEGO authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAP.html">Configuring uWSGI with LDAP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Erlang.html">Integrating uWSGI with Erlang</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagementFlag.html">Management Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="Go.html">uWSGI Go support (1.4 only)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.18.html">uWSGI 2.0.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.1.html">uWSGI 2.0.17.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.html">uWSGI 2.0.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.16.html">uWSGI 2.0.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.15.html">uWSGI 2.0.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.14.html">uWSGI 2.0.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.1.html">uWSGI 2.0.13.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.html">uWSGI 2.0.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.12.html">uWSGI 2.0.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.2.html">uWSGI 2.0.11.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.1.html">uWSGI 2.0.11.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.html">uWSGI 2.0.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.10.html">uWSGI 2.0.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.9.html">uWSGI 2.0.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.8.html">uWSGI 2.0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.7.html">uWSGI 2.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.6.html">uWSGI 2.0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.5.html">uWSGI 2.0.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.4.html">uWSGI 2.0.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.3.html">uWSGI 2.0.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.2.html">uWSGI 2.0.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.1.html">uWSGI 2.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.html">uWSGI 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.21.html">uWSGI 1.9.21</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.20.html">uWSGI 1.9.20</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.19.html">uWSGI 1.9.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.18.html">uWSGI 1.9.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.17.html">uWSGI 1.9.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.16.html">uWSGI 1.9.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.15.html">uWSGI 1.9.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.14.html">uWSGI 1.9.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.13.html">uWSGI 1.9.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.12.html">uWSGI 1.9.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.11.html">uWSGI 1.9.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.10.html">uWSGI 1.9.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.9.html">uWSGI 1.9.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.8.html">uWSGI 1.9.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.7.html">uWSGI 1.9.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.6.html">uWSGI 1.9.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.5.html">uWSGI 1.9.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.4.html">uWSGI 1.9.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.3.html">uWSGI 1.9.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.2.html">uWSGI 1.9.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.1.html">uWSGI 1.9.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.html">uWSGI 1.9</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">uWSGI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>uWSGI internal routing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/InternalRouting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uwsgi-internal-routing">
<h1>uWSGI internal routing<a class="headerlink" href="#uwsgi-internal-routing" title="제목 주소">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">Updated</span> <span class="pre">to</span> <span class="pre">1.9</span></code></p>
<p>As of uWSGI 1.9, a programmable internal routing subsystem is available (older
releases after 1.1 have a less featureful version).  You can use the internal
routing subsystem to dynamically alter the way requests are handled. For
example you can use it to trigger a 301 redirect on specific URLs, or to serve
content from the cache on specific conditions.  The internal routing subsystem
is inspired by Apache's <code class="docutils literal notranslate"><span class="pre">mod_rewrite</span></code> and Linux's <code class="docutils literal notranslate"><span class="pre">iptables</span></code> command.
Please, before blasting it for being messy, not-elegant nor Turing-complete,
remember that it must be FAST and only FAST.  If you need elegance and more
complexity, do that in your code.</p>
<div class="section" id="the-routing-chains">
<h2>The routing chains<a class="headerlink" href="#the-routing-chains" title="제목 주소">¶</a></h2>
<p>During the request cycle, various &quot;chains&quot; are traversed. Each chain contains a routing table (see below).</p>
<p>Chains can be &quot;recursive&quot;. A &quot;recursive&quot; chain can be called multiple times in a request cycle.</p>
<p>This is the order of chains:</p>
<p><code class="docutils literal notranslate"><span class="pre">request</span></code> it is applied before the request is passed to the plugin</p>
<p><code class="docutils literal notranslate"><span class="pre">error</span></code> it is applied as soon as an HTTP status code is generate (recursive chain)</p>
<p><code class="docutils literal notranslate"><span class="pre">response</span></code> it is is applied after the last response header has been generated (just before sending the body)</p>
<p><code class="docutils literal notranslate"><span class="pre">final</span></code> it is applied after the response has been sent to the client</p>
<p>The <code class="docutils literal notranslate"><span class="pre">request</span></code> chain is (for convention) the 'default' one, so its options are not prefixed, while the others require a prefix.</p>
<p>Example:</p>
<p><code class="docutils literal notranslate"><span class="pre">route-user-agent</span></code> -&gt; happens in the request chain</p>
<p>while</p>
<p><code class="docutils literal notranslate"><span class="pre">response-route-uri</span></code> -&gt; happens in the response chain</p>
</div>
<div class="section" id="the-internal-routing-table">
<h2>The internal routing table<a class="headerlink" href="#the-internal-routing-table" title="제목 주소">¶</a></h2>
<p>The internal routing table is a sequence of ''rules'' executed one after
another (forward jumps are allowed too).  Each rule is composed by a
''subject'', a ''condition'' and an ''action''. The ''condition'' is generally a
PCRE regexp applied to the subject: if it matches, the action is triggered.
Subjects are request's variables.  Currently the following subjects are
supported:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">host</span></code> (check HTTP_HOST)</li>
<li><code class="docutils literal notranslate"><span class="pre">uri</span></code> (check REQUEST_URI)</li>
<li><code class="docutils literal notranslate"><span class="pre">qs</span></code> (check QUERY_STRING)</li>
<li><code class="docutils literal notranslate"><span class="pre">remote-addr</span></code> (check REMOTE_ADDR)</li>
<li><code class="docutils literal notranslate"><span class="pre">remote-user</span></code> (check REMOTE_USER)</li>
<li><code class="docutils literal notranslate"><span class="pre">referer</span></code> (check HTTP_REFERER)</li>
<li><code class="docutils literal notranslate"><span class="pre">user-agent</span></code> (check HTTP_USER_AGENT)</li>
<li><code class="docutils literal notranslate"><span class="pre">status</span></code> (check HTTP response status code, not available in the request chain)</li>
<li><code class="docutils literal notranslate"><span class="pre">default</span></code> (default subject, maps to PATH_INFO)</li>
</ul>
<p>In addition to this, a pluggable system of lower-level conditions is available.
You can access this system using the <code class="docutils literal notranslate"><span class="pre">--route-if</span></code> option.  Currently the
following checks are supported:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">exists</span></code> (check if the subject exists in the filesystem)</li>
<li><code class="docutils literal notranslate"><span class="pre">isfile</span></code> (check if the subject is a file)</li>
<li><code class="docutils literal notranslate"><span class="pre">isdir</span></code> (check if the subject is a directory)</li>
<li><code class="docutils literal notranslate"><span class="pre">isexec</span></code> (check if the subject is an executable file)</li>
<li><code class="docutils literal notranslate"><span class="pre">equal</span></code>/<code class="docutils literal notranslate"><span class="pre">isequal</span></code>/<code class="docutils literal notranslate"><span class="pre">eq</span></code>/<code class="docutils literal notranslate"><span class="pre">==</span></code> (check if the subject is equal to the specified pattern)</li>
<li><code class="docutils literal notranslate"><span class="pre">ishigherequal</span></code>/<code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ishigher</span></code>/<code class="docutils literal notranslate"><span class="pre">&gt;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">islower</span></code>/<code class="docutils literal notranslate"><span class="pre">&lt;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">islowerequal</span></code>/<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">startswith</span></code> (check if the subject starts with the specified pattern)</li>
<li><code class="docutils literal notranslate"><span class="pre">endswith</span></code> (check if the subject ends with the specified pattern)</li>
<li><code class="docutils literal notranslate"><span class="pre">regexp</span></code>/re (check if the subject matches the specified regexp)</li>
<li><code class="docutils literal notranslate"><span class="pre">empty</span></code> (check if the subject is empty)</li>
<li><code class="docutils literal notranslate"><span class="pre">contains</span></code></li>
</ul>
<p>When a check requires a pattern (like with 'equal' or 'regexp') you split it
from the subject with a semicolon:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">; never matches</span>
<span class="na">route-if</span> <span class="o">=</span> <span class="s">equal:FOO;BAR log:never here</span>
<span class="c1">; matches</span>
<span class="na">route-if</span> <span class="o">=</span> <span class="s">regexp:FOO;^F log:starts with F</span>
</pre></div>
</div>
<p>Actions are the functions to run if a rule matches. These actions are exported
by plugins and have a return value.</p>
</div>
<div class="section" id="action-return-values">
<h2>Action return values<a class="headerlink" href="#action-return-values" title="제목 주소">¶</a></h2>
<p>Each action has a return value which tells the routing engine what to do next.
The following return codes are supported:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">NEXT</span></code> (continue to the next rule)</li>
<li><code class="docutils literal notranslate"><span class="pre">CONTINUE</span></code> (stop scanning the internal routing table and run the request)</li>
<li><code class="docutils literal notranslate"><span class="pre">BREAK</span></code> (stop scanning the internal routing table and close the request)</li>
<li><code class="docutils literal notranslate"><span class="pre">GOTO</span> <span class="pre">x</span></code> (go to rule <code class="docutils literal notranslate"><span class="pre">x</span></code>)</li>
</ul>
<p>When a rule does not match, <code class="docutils literal notranslate"><span class="pre">NEXT</span></code> is assumed.</p>
</div>
<div class="section" id="the-first-example">
<h2>The first example<a class="headerlink" href="#the-first-example" title="제목 주소">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route-user-agent</span> <span class="o">=</span> <span class="s">.*curl.* redirect:http://uwsgi.it</span>
<span class="na">route-remote-addr</span> <span class="o">=</span> <span class="s">^127\.0\.0\.1$ break:403 Forbidden</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/test log:someone called /test</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">\.php$ rewrite:/index.php</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* addheader:Server: my uWSGI server</span>
<span class="na">route-host</span> <span class="o">=</span> <span class="s">^localhost$ logvar:local=1</span>
<span class="na">route-uri</span> <span class="o">=</span> <span class="s">^/foo/(.*)\.jpg$ cache:key=$1.jpg</span>
<span class="na">route-if</span> <span class="o">=</span> <span class="s">equal:${PATH_INFO};/bad break:500 Internal Server Error</span>
</pre></div>
</div>
<p>The previous rules build the following table:</p>
<ul class="simple">
<li>if the <code class="docutils literal notranslate"><span class="pre">HTTP_USER_AGENT</span></code> var contains 'curl' redirect the request to
<a class="reference external" href="http://uwsgi.it">http://uwsgi.it</a> (code 302, action returns BREAK)</li>
<li>if <code class="docutils literal notranslate"><span class="pre">REMOTE_ADDR</span></code> is '127.0.0.1' returns a 403 Forbidden (action returns
BREAK)</li>
<li>if <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> starts with /test print the string 'someone called /test' in
the logs (action returns NEXT)</li>
<li>if <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> ends with '.php' rewrite it to /index.php (action returns
NEXT)</li>
<li>for all of the <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> add the HTTP header 'Server: my uWSGI server' to
the response (action returns NEXT)</li>
<li>if <code class="docutils literal notranslate"><span class="pre">HTTP_HOST</span></code> is localhost add the logvar 'local' setting it to '1'</li>
<li>if <code class="docutils literal notranslate"><span class="pre">REQUEST_URI</span></code> starts with /foo and ends with .jpg get it from the uWSGI
cache using the supplied key (built over regexp grouping) (action returns
BREAK)</li>
<li>if the <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code> is equal to /bad throws a 500 error</li>
</ul>
</div>
<div class="section" id="accessing-request-vars">
<h2>Accessing request vars<a class="headerlink" href="#accessing-request-vars" title="제목 주소">¶</a></h2>
<p>In addition to PCRE placeholders/groups (using $1 to $9) you can access request
variables (PATH_INFO, SCRIPT_NAME, REQUEST_METHOD...) using the ${VAR} syntax.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route-user-agent</span> <span class="o">=</span> <span class="s">.*curl.* redirect:http://uwsgi.it${REQUEST_URI}</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-cookies">
<h2>Accessing cookies<a class="headerlink" href="#accessing-cookies" title="제목 주소">¶</a></h2>
<p>You can access a cookie value using the ${cookie[name]} syntax:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo log:${cookie[foobar]}</span>
</pre></div>
</div>
<p>This will log the content of the 'foobar' cookie of the current request</p>
</div>
<div class="section" id="accessing-query-string-items">
<h2>Accessing query string items<a class="headerlink" href="#accessing-query-string-items" title="제목 주소">¶</a></h2>
<p>You can access the value of the HTTP query string using the ${qs[name]} syntax:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo log:${qs[foobar]}</span>
</pre></div>
</div>
<p>This will log the content of the 'foobar' item of the current request's query string</p>
</div>
<div class="section" id="pluggable-routing-variables">
<h2>Pluggable routing variables<a class="headerlink" href="#pluggable-routing-variables" title="제목 주소">¶</a></h2>
<p>Both the cookie and qs vars, are so-called &quot;routing vars&quot;. They are pluggable,
so external plugins can add new vars to add new features to your application.
(Check the <a class="reference internal" href="GeoIP.html"><span class="doc">The GeoIP plugin</span></a> plugin for an example of this.) A number of embedded
routing variables are also available.</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">mime</span></code> -- returns the mime type of the specified var: ${mime[REQUEST_URI]}</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/images/(.+) addvar:MYFILE=$1.jpg</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/images/ addheader:Content-Type: ${mime[MYFILE]}</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">time</span></code> -- returns time/date in various forms. The only supported (for now) is time[unix] returning the epoch</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">httptime</span></code> -- return http date adding the numeric argument (if specified) to the current time (use empty arg for current server time)</p>
</li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="c1">; add Date header</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">addheader:Date ${httptime[]}</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">math</span></code> -- requires matheval support. Example: math[CONTENT_LENGTH+1]</li>
<li><code class="docutils literal notranslate"><span class="pre">base64</span></code> -- encode the specified var in base64</li>
<li><code class="docutils literal notranslate"><span class="pre">hex</span></code> -- encode the specified var in hex</li>
<li><code class="docutils literal notranslate"><span class="pre">upper</span></code> -- uppercase the specified var</li>
<li><code class="docutils literal notranslate"><span class="pre">lower</span></code> -- lowercase the specified var</li>
<li><code class="docutils literal notranslate"><span class="pre">uwsgi</span></code> -- return internal uWSGI information, uwsgi[wid], uwsgi[pid], uwsgi[uuid] and uwsgi[status] are currently supported</li>
</ul>
</div>
<div class="section" id="is-route-if-not-enough-why-route-uri-and-friends">
<h2>Is --route-if not enough? Why --route-uri and friends?<a class="headerlink" href="#is-route-if-not-enough-why-route-uri-and-friends" title="제목 주소">¶</a></h2>
<p>This is a good question. You just need to always remember that uWSGI is about
versatility and <em>performance</em>. Gaining cycles is always good. The
<code class="docutils literal notranslate"><span class="pre">--route-if</span></code> option, while versatile, cannot be optimized as all of its parts
have to be recomputed on every request.  This is obviously very fast, but the
<code class="docutils literal notranslate"><span class="pre">--route-uri</span></code> option (and friends) can be pre-optimized (during startup) to
directly map to the request memory areas, so if you can use them, you
definitely should. :)</p>
</div>
<div class="section" id="goto">
<h2>GOTO<a class="headerlink" href="#goto" title="제목 주소">¶</a></h2>
<p>Yes, the most controversial construct of the whole information technology
industry (and history) is here. You can make forward (only forward!) jumps to
specific points of the internal routing table. You can set labels to mark
specific point of the table, or if you are brave (or foolish) jump directly to
a rule number. Rule numbers are printed on server startup, but please use
labels.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>

<span class="na">route-host</span> <span class="o">=</span> <span class="s">^localhost$ goto:localhost</span>
<span class="na">route-host</span> <span class="o">=</span> <span class="s">^sid\.local$ goto:sid.local</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* last:</span>

<span class="na">route-label</span> <span class="o">=</span> <span class="s">sid.local</span>
<span class="na">route-user-agent</span> <span class="o">=</span> <span class="s">.*curl.* redirect:http://uwsgi.it</span>
<span class="na">route-remote-addr</span> <span class="o">=</span> <span class="s">^192\.168\..* break:403 Forbidden</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/test log:someone called /test</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">\.php$ rewrite:/index.php</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* addheader:Server: my sid.local server</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* logvar:local=0</span>
<span class="na">route-uri</span> <span class="o">=</span> <span class="s">^/foo/(.*)\.jpg$ cache:key=$1.jpg</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* last:</span>

<span class="na">route-label</span> <span class="o">=</span> <span class="s">localhost</span>
<span class="na">route-user-agent</span> <span class="o">=</span> <span class="s">.*curl.* redirect:http://uwsgi.it</span>
<span class="na">route-remote-addr</span> <span class="o">=</span> <span class="s">^127\.0\.0\.1$ break:403 Forbidden</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/test log:someone called /test</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">\.php$ rewrite:/index.php</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* addheader:Server: my uWSGI server</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* logvar:local=1</span>
<span class="na">route-uri</span> <span class="o">=</span> <span class="s">^/foo/(.*)\.jpg$ cache:key=$1.jpg</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">.* last:</span>
</pre></div>
</div>
<p>The example is like the previous one, but with some differences between
domains. Check the use of &quot;last:&quot;, to interrupt the routing table scan. You can
rewrite the first 2 rules as one:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>

<span class="na">route-host</span> <span class="o">=</span> <span class="s">(.*) goto:$1</span>
</pre></div>
</div>
</div>
<div class="section" id="collecting-response-headers">
<h2>Collecting response headers<a class="headerlink" href="#collecting-response-headers" title="제목 주소">¶</a></h2>
<p>As we have already seen, each uWSGI request has a set of variables associated. They are generally the CGI vars passed by the webserver, but you can
extend them with other variables too (check the 'addvar' action).</p>
<p>uWSGI 1.9.16 added a new feature allowing you to store the content of a response header in a request var. This makes writing more advanced rules much simpler.</p>
<p>For example you may want to gzip all of the text/html responses:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="c1">; store Content-Type response header in MY_CONTENT_TYPE var</span>
<span class="na">collect-header</span> <span class="o">=</span> <span class="s">Content-Type MY_CONTENT_TYPE</span>
<span class="c1">; if response is text/html, and client supports it, gzip it</span>
<span class="na">response-route-if</span> <span class="o">=</span> <span class="s">equal:${MY_CONTENT_TYPE};text/html goto:gzipme</span>
<span class="na">response-route-run</span> <span class="o">=</span> <span class="s">last:</span>

<span class="na">response-route-label</span> <span class="o">=</span> <span class="s">gzipme</span>
<span class="c1">; gzip only if the client support it</span>
<span class="na">response-route-if</span> <span class="o">=</span> <span class="s">contains:${HTTP_ACCEPT_ENCODING};gzip gzip:</span>
</pre></div>
</div>
</div>
<div class="section" id="the-available-actions">
<h2>The available actions<a class="headerlink" href="#the-available-actions" title="제목 주소">¶</a></h2>
<div class="section" id="continue-last">
<h3><code class="docutils literal notranslate"><span class="pre">continue</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code><a class="headerlink" href="#continue-last" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">CONTINUE</span></code></p>
<p>Stop scanning the internal routing table and continue to the selected request
handler.</p>
</div>
<div class="section" id="break">
<h3><code class="docutils literal notranslate"><span class="pre">break</span></code><a class="headerlink" href="#break" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Stop scanning the internal routing table and close the request. Can optionally
return the specified HTTP status code:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/notfound break:404 Not Found</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/bad break:</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/error break:500</span>
</pre></div>
</div>
<p>Note: <code class="docutils literal notranslate"><span class="pre">break</span></code> doesn't support request variables because it's intended to notify
browser about the error, not the end user. That said, we can tell following code
will send what it reads to browser (i.e. without <code class="docutils literal notranslate"><span class="pre">${REMOTE_ADDR}</span></code> being
translated to the remote IP address).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route-remote-addr</span> <span class="o">=</span> <span class="s">^127\.0\.0\.1$ break:403 Forbidden for ip ${REMOTE_ADDR}</span>
</pre></div>
</div>
<p>If you really do want to do wacky stuff, see <code class="docutils literal notranslate"><span class="pre">clearheaders</span></code>.</p>
</div>
<div class="section" id="return-break-with-status">
<h3><code class="docutils literal notranslate"><span class="pre">return</span></code>/<code class="docutils literal notranslate"><span class="pre">break-with-status</span></code><a class="headerlink" href="#return-break-with-status" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">return</span></code> uses uWSGI's built-in status code and returns both status code and
message body. It's similar to <code class="docutils literal notranslate"><span class="pre">break</span></code>, but as mentioned above <code class="docutils literal notranslate"><span class="pre">break</span></code>
doesn't have the error message body. <code class="docutils literal notranslate"><span class="pre">return:403</span></code> is equivalent to following:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
 <span class="na">route-run</span> <span class="o">=</span> <span class="s">clearheaders:403 Forbidden</span>
<span class="s"> route-run = addheader:Content-Type: text/plain</span>
<span class="s"> route-run = addheader:Content-Length: 9</span>
<span class="s"> route-run = send:Forbidden</span>
<span class="s"> route-run = break:</span>
</pre></div>
</div>
</div>
<div class="section" id="log">
<h3><code class="docutils literal notranslate"><span class="pre">log</span></code><a class="headerlink" href="#log" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Print the specified message in the logs.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/logme/(.) log:hey i am printing $1</span>
</pre></div>
</div>
</div>
<div class="section" id="logvar">
<h3><code class="docutils literal notranslate"><span class="pre">logvar</span></code><a class="headerlink" href="#logvar" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Add the specified logvar.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/logme/(.) logvar:item=$1</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3><code class="docutils literal notranslate"><span class="pre">goto</span></code><a class="headerlink" href="#id1" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Make a forward jump to the specified label or rule position.</p>
</div>
<div class="section" id="addvar">
<h3><code class="docutils literal notranslate"><span class="pre">addvar</span></code><a class="headerlink" href="#addvar" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Add the specified CGI (environment) variable to the request.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo/(.) addvar:FOOVAR=prefix$1suffix</span>
</pre></div>
</div>
</div>
<div class="section" id="addheader">
<h3><code class="docutils literal notranslate"><span class="pre">addheader</span></code><a class="headerlink" href="#addheader" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Add the specified HTTP header to the response.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo/(.) addheader:Foo: Bar</span>
</pre></div>
</div>
</div>
<div class="section" id="delheader-remheader">
<h3><code class="docutils literal notranslate"><span class="pre">delheader</span></code>//<code class="docutils literal notranslate"><span class="pre">remheader</span></code><a class="headerlink" href="#delheader-remheader" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Remove the specified HTTP header from the response.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo/(.) delheader:Foo</span>
</pre></div>
</div>
</div>
<div class="section" id="signal">
<h3><code class="docutils literal notranslate"><span class="pre">signal</span></code><a class="headerlink" href="#signal" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Raise the specified uwsgi signal.</p>
</div>
<div class="section" id="send">
<h3><code class="docutils literal notranslate"><span class="pre">send</span></code><a class="headerlink" href="#send" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Extremely advanced (and dangerous) function allowing you to add raw data to the
response.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo/(.) send:destroy the world</span>
</pre></div>
</div>
</div>
<div class="section" id="send-crnl">
<h3><code class="docutils literal notranslate"><span class="pre">send-crnl</span></code><a class="headerlink" href="#send-crnl" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Extremely advanced (and dangerous) function allowing you to add raw data to the
response, suffixed with rn.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo/(.) send-crnl:HTTP/1.0 100 Continue</span>
</pre></div>
</div>
</div>
<div class="section" id="redirect-redirect-302">
<h3><code class="docutils literal notranslate"><span class="pre">redirect</span></code>/<code class="docutils literal notranslate"><span class="pre">redirect-302</span></code><a class="headerlink" href="#redirect-redirect-302" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redirect</span></code></p>
<p>Return a HTTP 302 Redirect to the specified URL.</p>
</div>
<div class="section" id="redirect-permanent-redirect-301">
<h3><code class="docutils literal notranslate"><span class="pre">redirect-permanent</span></code>/<code class="docutils literal notranslate"><span class="pre">redirect-301</span></code><a class="headerlink" href="#redirect-permanent-redirect-301" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redirect</span></code></p>
<p>Return a HTTP 301 Permanent Redirect to the specified URL.</p>
</div>
<div class="section" id="rewrite">
<h3><code class="docutils literal notranslate"><span class="pre">rewrite</span></code><a class="headerlink" href="#rewrite" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_rewrite</span></code></p>
<p>A rewriting engine inspired by Apache mod_rewrite. Rebuild PATH_INFO and
QUERY_STRING according to the specified rules before the request is dispatched
to the request handler.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route-uri</span> <span class="o">=</span> <span class="s">^/foo/(.*) rewrite:/index.php?page=$1.php</span>
</pre></div>
</div>
</div>
<div class="section" id="rewrite-last">
<h3><code class="docutils literal notranslate"><span class="pre">rewrite-last</span></code><a class="headerlink" href="#rewrite-last" title="제목 주소">¶</a></h3>
<p>Alias for rewrite but with a return value of <code class="docutils literal notranslate"><span class="pre">CONTINUE</span></code>, directly passing the
request to the request handler next.</p>
</div>
<div class="section" id="uwsgi">
<h3><code class="docutils literal notranslate"><span class="pre">uwsgi</span></code><a class="headerlink" href="#uwsgi" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_uwsgi</span></code></p>
<p>Rewrite the modifier1, modifier2 and optionally <code class="docutils literal notranslate"><span class="pre">UWSGI_APPID</span></code> values of a
request or route the request to an external uwsgi server.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/psgi uwsgi:127.0.0.1:3031,5,0</span>
</pre></div>
</div>
<p>This configuration routes all of the requests starting with <code class="docutils literal notranslate"><span class="pre">/psgi</span></code> to the
uwsgi server running on 127.0.0.1:3031 setting modifier1 to 5 and modifier2 to
0.  If you only want to change the modifiers without routing the request to an
external server, use the following syntax.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/psgi uwsgi:,5,0</span>
</pre></div>
</div>
<p>To set a specific <code class="docutils literal notranslate"><span class="pre">UWSGI_APPID</span></code> value, append it.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/psgi uwsgi:127.0.0.1:3031,5,0,fooapp</span>
</pre></div>
</div>
<p>The subrequest is async-friendly (engines such as gevent or ugreen are
supported) and if offload threads are available they will be used.</p>
</div>
<div class="section" id="http">
<h3><code class="docutils literal notranslate"><span class="pre">http</span></code><a class="headerlink" href="#http" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_http</span></code></p>
<p>Route the request to an external HTTP server.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/zope http:127.0.0.1:8181</span>
</pre></div>
</div>
<p>You can substitute an alternative Host header with the following syntax:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/zope http:127.0.0.1:8181,myzope.uwsgi.it</span>
</pre></div>
</div>
</div>
<div class="section" id="static">
<h3><code class="docutils literal notranslate"><span class="pre">static</span></code><a class="headerlink" href="#static" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_static</span></code></p>
<p>Serve a static file from the specified physical path.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/logo static:/var/www/logo.png</span>
</pre></div>
</div>
</div>
<div class="section" id="basicauth">
<h3><code class="docutils literal notranslate"><span class="pre">basicauth</span></code><a class="headerlink" href="#basicauth" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code> or <code class="docutils literal notranslate"><span class="pre">BREAK</span> <span class="pre">401</span></code> on failed authentication</p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_basicauth</span></code></p>
<p>Four syntaxes are supported.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">basicauth:realm,user:password</span></code> – a simple user:password mapping</li>
<li><code class="docutils literal notranslate"><span class="pre">basicauth:realm,user:</span></code> – only authenticates username</li>
<li><code class="docutils literal notranslate"><span class="pre">basicauth:realm,htpasswd</span></code> – use a htpasswd-like file. All POSIX
crypt() algorithms are supported. This is _not_ the same behavior as
Apache’s traditional htpasswd files, so use the <code class="docutils literal notranslate"><span class="pre">-d</span></code> flag of the htpasswd
utility to create compatible files.</li>
<li><code class="docutils literal notranslate"><span class="pre">basicauth:realm,</span></code> – Useful to cause a HTTP 401 response immediately.
As routes are parsed top-bottom, you may want to raise that to avoid bypassing
rules.</li>
</ul>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo basicauth-next:My Realm,foo:bar</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo basicauth:My Realm,foo2:bar2</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/bar basicauth:Another Realm,kratos:</span>
</pre></div>
</div>
<p>Example: using basicauth for Trac</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="c1">; load plugins (if required)</span>
<span class="na">plugins</span> <span class="o">=</span> <span class="s">python,router_basicauth</span>

<span class="c1">; bind to port 9090 using http protocol</span>
<span class="na">http-socket</span> <span class="o">=</span> <span class="s">:9090</span>

<span class="c1">; set trac instance path</span>
<span class="na">env</span> <span class="o">=</span> <span class="s">TRAC_ENV=myinstance</span>
<span class="c1">; load trac</span>
<span class="na">module</span> <span class="o">=</span> <span class="s">trac.web.main:dispatch_request</span>

<span class="c1">; trigger authentication on /login</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/login basicauth-next:Trac Realm,pippo:pluto</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/login basicauth:Trac Realm,foo:bar</span>

<span class="c1">;high performance file serving</span>
<span class="na">static-map</span> <span class="o">=</span> <span class="s">/chrome/common=/usr/local/lib/python2.7/dist-packages/trac/htdocs</span>
</pre></div>
</div>
</div>
<div class="section" id="basicauth-next">
<h3><code class="docutils literal notranslate"><span class="pre">basicauth-next</span></code><a class="headerlink" href="#basicauth-next" title="제목 주소">¶</a></h3>
<p>Same as <code class="docutils literal notranslate"><span class="pre">basicauth</span></code> but returns <code class="docutils literal notranslate"><span class="pre">NEXT</span></code> on failed authentication.</p>
</div>
<div class="section" id="ldapauth">
<h3><code class="docutils literal notranslate"><span class="pre">ldapauth</span></code><a class="headerlink" href="#ldapauth" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">NEXT</span></code> or <code class="docutils literal notranslate"><span class="pre">BREAK</span> <span class="pre">401</span></code> on failed authentication</p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">ldap</span></code></p>
<p>This auth router is part of the LDAP plugin, so it has to be loaded in order
for this to be available.  It's like the basicauth router, but uses an LDAP
server for authentication, syntax: <code class="docutils literal notranslate"><span class="pre">ldapauth:realm,options</span></code> Available
options:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">url</span></code> - LDAP server URI (required)</li>
<li><code class="docutils literal notranslate"><span class="pre">binddn</span></code> - DN used for binding. Required if the LDAP server does not allow
anonymous searches.</li>
<li><code class="docutils literal notranslate"><span class="pre">bindpw</span></code> - password for the <code class="docutils literal notranslate"><span class="pre">binddn</span></code> user.</li>
<li><code class="docutils literal notranslate"><span class="pre">basedn</span></code> - base DN used when searching for users (required)</li>
<li><code class="docutils literal notranslate"><span class="pre">filter</span></code> - filter used when searching for users (default is
&quot;(objectClass=*)&quot;)</li>
<li><code class="docutils literal notranslate"><span class="pre">attr</span></code> - LDAP attribute that holds user login (default is &quot;uid&quot;)</li>
<li><code class="docutils literal notranslate"><span class="pre">loglevel</span></code> - 0 - don't log any binds, 1 - log authentication errors, 2 -
log both successful and failed binds</li>
</ul>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">route</span> <span class="o">=</span> <span class="s">^/protected ldapauth:LDAP auth realm,url=ldap://ldap.domain.com;basedn=ou=users,dc=domain;binddn=uid=proxy,ou=users,dc=domain;bindpw=password;loglevel=1;filter=(objectClass=posixAccount)</span>
</pre></div>
</div>
</div>
<div class="section" id="ldapauth-next">
<h3><code class="docutils literal notranslate"><span class="pre">ldapauth-next</span></code><a class="headerlink" href="#ldapauth-next" title="제목 주소">¶</a></h3>
<p>Same as ldapauth but returns <code class="docutils literal notranslate"><span class="pre">NEXT</span></code> on failed authentication.</p>
</div>
<div class="section" id="cache">
<h3><code class="docutils literal notranslate"><span class="pre">cache</span></code><a class="headerlink" href="#cache" title="제목 주소">¶</a></h3>
<p>Return value: <code class="docutils literal notranslate"><span class="pre">BREAK</span></code></p>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="cachestore-cache-store">
<h3><code class="docutils literal notranslate"><span class="pre">cachestore</span></code>/<code class="docutils literal notranslate"><span class="pre">cache-store</span></code><a class="headerlink" href="#cachestore-cache-store" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="cachevar">
<h3><code class="docutils literal notranslate"><span class="pre">cachevar</span></code><a class="headerlink" href="#cachevar" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="cacheset">
<h3><code class="docutils literal notranslate"><span class="pre">cacheset</span></code><a class="headerlink" href="#cacheset" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="memcached">
<h3><code class="docutils literal notranslate"><span class="pre">memcached</span></code><a class="headerlink" href="#memcached" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="rpc">
<h3><code class="docutils literal notranslate"><span class="pre">rpc</span></code><a class="headerlink" href="#rpc" title="제목 주소">¶</a></h3>
<p>The &quot;rpc&quot; routing instruction allows you to call uWSGI RPC functions directly
from the routing subsystem and forward their output to the client.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">http-socket</span> <span class="o">=</span> <span class="s">:9090</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo addheader:Content-Type: text/html</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/foo rpc:hello ${REQUEST_URI} ${HTTP_USER_AGENT}</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/bar/(.+)$ rpc:test $1 ${REMOTE_ADDR} uWSGI %V</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">^/pippo/(.+)$ rpc:test@127.0.0.1:4141 $1 ${REMOTE_ADDR} uWSGI %V</span>
<span class="na">import</span> <span class="o">=</span> <span class="s">funcs.py</span>
</pre></div>
</div>
</div>
<div class="section" id="call">
<h3><code class="docutils literal notranslate"><span class="pre">call</span></code><a class="headerlink" href="#call" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">rpc</span></code></p>
</div>
<div class="section" id="rpcret">
<h3><code class="docutils literal notranslate"><span class="pre">rpcret</span></code><a class="headerlink" href="#rpcret" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">rpc</span></code></p>
<p><cite>rpcret</cite> calls the specified rpc function and uses its return value as the
action return code (next, continue, goto, etc)</p>
</div>
<div class="section" id="rpcblob-rpcnext">
<h3><code class="docutils literal notranslate"><span class="pre">rpcblob</span></code>//<code class="docutils literal notranslate"><span class="pre">rpcnext</span></code><a class="headerlink" href="#rpcblob-rpcnext" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">rpc</span></code></p>
<p><cite>rpcnext/rpcblob</cite> calls the specified RPC function, sends the response to the
client and continues to the next rule.</p>
</div>
<div class="section" id="rpcraw">
<h3><code class="docutils literal notranslate"><span class="pre">rpcraw</span></code><a class="headerlink" href="#rpcraw" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">rpc</span></code></p>
</div>
<div class="section" id="rpcvar">
<h3><code class="docutils literal notranslate"><span class="pre">rpcvar</span></code><a class="headerlink" href="#rpcvar" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">rpc</span></code></p>
<p>Calls the specified rpc function and assigns its return value to the specified CGI environ variable.</p>
</div>
<div class="section" id="access">
<h3><code class="docutils literal notranslate"><span class="pre">access</span></code><a class="headerlink" href="#access" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="spnego">
<h3><code class="docutils literal notranslate"><span class="pre">spnego</span></code><a class="headerlink" href="#spnego" title="제목 주소">¶</a></h3>
<p>In development...</p>
</div>
<div class="section" id="radius">
<h3><code class="docutils literal notranslate"><span class="pre">radius</span></code><a class="headerlink" href="#radius" title="제목 주소">¶</a></h3>
<p>In development...</p>
</div>
<div class="section" id="xslt">
<h3><code class="docutils literal notranslate"><span class="pre">xslt</span></code><a class="headerlink" href="#xslt" title="제목 주소">¶</a></h3>
<div class="admonition seealso">
<p class="first admonition-title">더 보기</p>
<p class="last"><a class="reference internal" href="XSLT.html"><span class="doc">The XSLT plugin</span></a></p>
</div>
</div>
<div class="section" id="ssi">
<h3>ssi<a class="headerlink" href="#ssi" title="제목 주소">¶</a></h3>
<div class="admonition seealso">
<p class="first admonition-title">더 보기</p>
<p class="last"><a class="reference internal" href="SSI.html"><span class="doc">SSI (Server Side Includes) plugin</span></a></p>
</div>
</div>
<div class="section" id="gridfs">
<h3>gridfs<a class="headerlink" href="#gridfs" title="제목 주소">¶</a></h3>
<div class="admonition seealso">
<p class="first admonition-title">더 보기</p>
<p class="last"><a class="reference internal" href="GridFS.html"><span class="doc">The GridFS plugin</span></a></p>
</div>
</div>
<div class="section" id="donotlog">
<h3><code class="docutils literal notranslate"><span class="pre">donotlog</span></code><a class="headerlink" href="#donotlog" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="chdir">
<h3><code class="docutils literal notranslate"><span class="pre">chdir</span></code><a class="headerlink" href="#chdir" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="seturi">
<h3><code class="docutils literal notranslate"><span class="pre">seturi</span></code><a class="headerlink" href="#seturi" title="제목 주소">¶</a></h3>
<p>Updates <cite>REQUEST_URI</cite></p>
</div>
<div class="section" id="setapp">
<h3><code class="docutils literal notranslate"><span class="pre">setapp</span></code><a class="headerlink" href="#setapp" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="setuser">
<h3><code class="docutils literal notranslate"><span class="pre">setuser</span></code><a class="headerlink" href="#setuser" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="sethome">
<h3><code class="docutils literal notranslate"><span class="pre">sethome</span></code><a class="headerlink" href="#sethome" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="setfile">
<h3><code class="docutils literal notranslate"><span class="pre">setfile</span></code><a class="headerlink" href="#setfile" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="setscriptname">
<h3><code class="docutils literal notranslate"><span class="pre">setscriptname</span></code><a class="headerlink" href="#setscriptname" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="setprocname">
<h3><code class="docutils literal notranslate"><span class="pre">setprocname</span></code><a class="headerlink" href="#setprocname" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="alarm">
<h3><code class="docutils literal notranslate"><span class="pre">alarm</span></code><a class="headerlink" href="#alarm" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="flush">
<h3><code class="docutils literal notranslate"><span class="pre">flush</span></code><a class="headerlink" href="#flush" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="fixcl">
<h3><code class="docutils literal notranslate"><span class="pre">fixcl</span></code><a class="headerlink" href="#fixcl" title="제목 주소">¶</a></h3>
</div>
<div class="section" id="cgi">
<h3><code class="docutils literal notranslate"><span class="pre">cgi</span></code><a class="headerlink" href="#cgi" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">cgi</span></code></p>
</div>
<div class="section" id="cgihelper">
<h3><code class="docutils literal notranslate"><span class="pre">cgihelper</span></code><a class="headerlink" href="#cgihelper" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">cgi</span></code></p>
</div>
<div class="section" id="id2">
<h3><code class="docutils literal notranslate"><span class="pre">access</span></code><a class="headerlink" href="#id2" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_access</span></code></p>
</div>
<div class="section" id="cache-continue">
<h3><code class="docutils literal notranslate"><span class="pre">cache-continue</span></code><a class="headerlink" href="#cache-continue" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="id3">
<h3><code class="docutils literal notranslate"><span class="pre">cachevar</span></code><a class="headerlink" href="#id3" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="cacheinc">
<h3><code class="docutils literal notranslate"><span class="pre">cacheinc</span></code><a class="headerlink" href="#cacheinc" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="cachedec">
<h3><code class="docutils literal notranslate"><span class="pre">cachedec</span></code><a class="headerlink" href="#cachedec" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="cachemul">
<h3><code class="docutils literal notranslate"><span class="pre">cachemul</span></code><a class="headerlink" href="#cachemul" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="cachediv">
<h3><code class="docutils literal notranslate"><span class="pre">cachediv</span></code><a class="headerlink" href="#cachediv" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_cache</span></code></p>
</div>
<div class="section" id="proxyhttp">
<h3><code class="docutils literal notranslate"><span class="pre">proxyhttp</span></code><a class="headerlink" href="#proxyhttp" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_http</span></code></p>
</div>
<div class="section" id="id4">
<h3><code class="docutils literal notranslate"><span class="pre">memcached</span></code><a class="headerlink" href="#id4" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_memcached</span></code></p>
</div>
<div class="section" id="memcached-continue">
<h3><code class="docutils literal notranslate"><span class="pre">memcached-continue</span></code><a class="headerlink" href="#memcached-continue" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_memcached</span></code></p>
</div>
<div class="section" id="memcachedstore">
<h3><code class="docutils literal notranslate"><span class="pre">memcachedstore</span></code><a class="headerlink" href="#memcachedstore" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_memcached</span></code></p>
</div>
<div class="section" id="memcached-store">
<h3><code class="docutils literal notranslate"><span class="pre">memcached-store</span></code><a class="headerlink" href="#memcached-store" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_memcached</span></code></p>
</div>
<div class="section" id="redis">
<h3><code class="docutils literal notranslate"><span class="pre">redis</span></code><a class="headerlink" href="#redis" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redis</span></code></p>
</div>
<div class="section" id="redis-continue">
<h3><code class="docutils literal notranslate"><span class="pre">redis-continue</span></code><a class="headerlink" href="#redis-continue" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redis</span></code></p>
</div>
<div class="section" id="redisstore">
<h3><code class="docutils literal notranslate"><span class="pre">redisstore</span></code><a class="headerlink" href="#redisstore" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redis</span></code></p>
</div>
<div class="section" id="redis-store">
<h3><code class="docutils literal notranslate"><span class="pre">redis-store</span></code><a class="headerlink" href="#redis-store" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_redis</span></code></p>
</div>
<div class="section" id="proxyuwsgi">
<h3><code class="docutils literal notranslate"><span class="pre">proxyuwsgi</span></code><a class="headerlink" href="#proxyuwsgi" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">router_uwsgi</span></code></p>
</div>
<div class="section" id="harakiri">
<h3><code class="docutils literal notranslate"><span class="pre">harakiri</span></code><a class="headerlink" href="#harakiri" title="제목 주소">¶</a></h3>
<p>Set harakiri for the current request.</p>
</div>
<div class="section" id="file">
<h3><code class="docutils literal notranslate"><span class="pre">file</span></code><a class="headerlink" href="#file" title="제목 주소">¶</a></h3>
<p>Directly transfer the specified filename <em>without</em> using acceleration (sendfile, offloading, etc.).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">http-socket</span> <span class="o">=</span> <span class="s">:9090</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">file:filename=/var/www/${PATH_INFO}</span>
</pre></div>
</div>
</div>
<div class="section" id="clearheaders">
<h3><code class="docutils literal notranslate"><span class="pre">clearheaders</span></code><a class="headerlink" href="#clearheaders" title="제목 주소">¶</a></h3>
<p>Clear the response headers, setting a new HTTP status code, useful for resetting a response</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">http-socket</span> <span class="o">=</span> <span class="s">:9090</span>
<span class="na">response-route</span> <span class="o">=</span> <span class="s">^/foo goto:foobar</span>
<span class="na">response-route-run</span> <span class="o">=</span> <span class="s">last:</span>

<span class="na">response-route-label</span> <span class="o">=</span> <span class="s">foobar</span>
<span class="na">response-route-run</span> <span class="o">=</span> <span class="s">clearheaders:404 Not Found</span>
<span class="na">response-route-run</span> <span class="o">=</span> <span class="s">addheader:Content-Type: text/html</span>
</pre></div>
</div>
</div>
<div class="section" id="resetheaders">
<h3><code class="docutils literal notranslate"><span class="pre">resetheaders</span></code><a class="headerlink" href="#resetheaders" title="제목 주소">¶</a></h3>
<p>Alias for clearheaders</p>
</div>
<div class="section" id="xattr">
<h3><code class="docutils literal notranslate"><span class="pre">xattr</span></code><a class="headerlink" href="#xattr" title="제목 주소">¶</a></h3>
<p>Plugin: <code class="docutils literal notranslate"><span class="pre">xattr</span></code></p>
<p>The xattr plugin allows you to reference files extended attributes in the internal routing subsystem:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">...</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">addvar:MYATTR=user.uwsgi.foo.bar</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">log:The attribute is ${xattr[/tmp/foo:MYATTR]}</span>
</pre></div>
</div>
<p>or (variant with 2 vars)</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">...</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">addvar:MYFILE=/tmp/foo</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">addvar:MYATTR=user.uwsgi.foo.bar</span>
<span class="na">route-run</span> <span class="o">=</span> <span class="s">log:The attribute is ${xattr2[MYFILE:MYATTR]}</span>
</pre></div>
</div>
<p>It work only on linux platforms.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Legion.html" class="btn btn-neutral float-right" title="The uWSGI Legion subsystem" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Fastrouter.html" class="btn btn-neutral" title="The uWSGI FastRouter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2016, uWSGI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ko',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>