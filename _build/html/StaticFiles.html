

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ko" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ko" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Serving static files with uWSGI (updated to 1.9) &mdash; uWSGI 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="SNI - Server Name Identification (virtual hosting for SSL nodes)" href="SNI.html" />
    <link rel="prev" title="uWSGI Subscription Server" href="SubscriptionServer.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> uWSGI
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="WSGIquickstart.html">Quickstart for Python/WSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSGIquickstart.html">Quickstart for perl/PSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RackQuickstart.html">Quickstart for ruby/Rack applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Snippets.html">Snippets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Download.html">Getting uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildSystem.html">The uWSGI build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Management.html">Managing the uWSGI server</a></li>
<li class="toctree-l1"><a class="reference internal" href="LanguagesAndPlatforms.html">Supported languages and platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupportedPlatforms.html">Supported Platforms/Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServers.html">Web server integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThingsToKnow.html">Things to know (best practices and &quot;issues&quot;) READ IT !!!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuring uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="FallbackConfig.html">Fallback configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConfigLogic.html">Configuration logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">uWSGI Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="CustomOptions.html">Defining new options for your instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParsingOrder.html">How uWSGI parses config files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vars.html">uwsgi protocol magic variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protocol.html">The uwsgi Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="AttachingDaemons.html">Managing external daemons/services</a></li>
<li class="toctree-l1"><a class="reference internal" href="MasterFIFO.html">The Master FIFO</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inetd.html">Socket activation with inetd/xinetd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Upstart.html">Running uWSGI via Upstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Systemd.html">Systemd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Circus.html">Running uWSGI instances with Circus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Embed.html">Embedding an application in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogFormat.html">Formatting uWSGI requests logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogEncoders.html">Log encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkerOverride.html">Overriding Workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThirdPartyPlugins.html">uWSGI third party plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/CachingCookbook.html">The uWSGI Caching Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/Django_and_nginx.html">Setting up Django and your web server with uWSGI and nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/dreamhost.html">Running uWSGI on Dreamhost shared hosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_python.html">Running python webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_ruby.html">Running Ruby/Rack webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ReliableFuse.html">Reliably use FUSE filesystems for uWSGI vassals (with Linux)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/DynamicProxying.html">Build a dynamic proxy using RPC and internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/GraphiteAndMetrics.html">Setting up Graphite on Ubuntu using the Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="articles/SerializingAccept.html">Serializing accept(), AKA Thundering Herd, AKA the Zeeg Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/TheArtOfGracefulReloading.html">The Art of Graceful Reloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/FunWithPerlEyetoyRaspberrypi.html">Fun with Perl, Eyetoy and RaspberryPi</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/OffloadingWebsocketsAndSSE.html">Offloading Websockets and Server-Sent Events AKA &quot;Combine them with Django safely&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/WSGIEnvBehaviour.html">WSGI env behaviour policies</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="AlarmSubsystem.html">The uWSGI alarm subsystem (from 1.3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Caching.html">The uWSGI caching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebCaching.html">WebCaching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cron.html">The uWSGI cron-like interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fastrouter.html">The uWSGI FastRouter</a></li>
<li class="toctree-l1"><a class="reference internal" href="InternalRouting.html">uWSGI internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Legion.html">The uWSGI Legion subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Locks.html">Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mules.html">uWSGI Mules</a></li>
<li class="toctree-l1"><a class="reference internal" href="OffloadSubsystem.html">The uWSGI offloading subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Queue.html">The uWSGI queue framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="RPC.html">uWSGI RPC Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="SharedArea.html">SharedArea -- share memory pages between uWSGI components</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signals.html">The uWSGI Signal Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spooler.html">The uWSGI Spooler</a></li>
<li class="toctree-l1"><a class="reference internal" href="SubscriptionServer.html">uWSGI Subscription Server</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Serving static files with uWSGI (updated to 1.9)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mode-1-check-for-a-static-resource-before-passing-the-request-to-your-app">Mode 1: Check for a static resource before passing the request to your app</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mode-2-trust-frontend-s-document-root">Mode 2: trust frontend's DOCUMENT_ROOT</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mode-3-using-static-file-mount-points">Mode 3: using static file mount points</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mode-4-using-advanced-internal-routing">Mode 4: using advanced internal routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-the-index-page">Setting the index page</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mime-types">MIME types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#skipping-specific-extensions">Skipping specific extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-the-expires-headers">Setting the Expires headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transfer-modes">Transfer modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#x-sendfile">X-Sendfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#x-accel-redirect">X-Accel-Redirect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offloading">Offloading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gzip-uwsgi-1-9">GZIP (uWSGI 1.9)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caching-paths-mappings-resolutions">Caching paths mappings/resolutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bonus-trick-storing-static-files-in-the-cache">Bonus trick: storing static files in the cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SNI.html">SNI - Server Name Identification (virtual hosting for SSL nodes)</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeoIP.html">The GeoIP plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transformations.html">uWSGI Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebSockets.html">WebSocket support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chunked.html">The Chunked input API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Cheaper.html">The uWSGI cheaper subsystem -- adaptive process spawning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Emperor.html">The uWSGI Emperor -- multi-app deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Broodlord.html">Auto-scaling with Broodlord mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zerg.html">Zerg mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicApps.html">Adding applications dynamically</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSLScaling.html">Scaling SSL connections (uWSGI 1.9)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Capabilities.html">Setting POSIX Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cgroups.html">Running uWSGI in a Linux CGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="KSM.html">Using Linux KSM in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html">Jailing your apps using Linux Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html#the-old-way-the-namespace-option">The old way: the --namespace option</a></li>
<li class="toctree-l1"><a class="reference internal" href="FreeBSDJails.html">FreeBSD Jails</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForkptyRouter.html">The Forkpty Router</a></li>
<li class="toctree-l1"><a class="reference internal" href="TunTapRouter.html">The TunTap Router</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nagios.html">Monitoring uWSGI with Nagios</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNMP.html">The embedded SNMP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="PushingStats.html">Pushing statistics (from 1.4)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carbon.html">Integration with Graphite/Carbon</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatsServer.html">The uWSGI Stats Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Async.html">uWSGI asynchronous/non-blocking modes (updated to uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gevent.html">The Gevent loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tornado.html">The Tornado loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="uGreen.html">uGreen -- uWSGI Green Threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncio.html">The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Apache.html">Apache support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cherokee.html">Cherokee support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTP.html">Native HTTP support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTPS.html">HTTPS 지원 (1.3 버전부터)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPDY.html">The SPDY router (uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lighttpd.html">Lighttpd support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mongrel2.html">Attaching uWSGI to Mongrel2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nginx.html">Nginx support</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html">Using OpenBSD httpd as proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html#notes">Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python support</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyPy.html">The PyPy plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="PHP.html">Running PHP scripts in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Perl.html">uWSGI Perl support (PSGI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ruby.html">Ruby support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lua.html">Using Lua/WSAPI with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="JVM.html">JVM in the uWSGI server (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mono.html">The Mono ASP.NET plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="CGI.html">Running CGI scripts on uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCCGO.html">The GCCGO plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Symcall.html">The Symcall plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLT.html">The XSLT plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSI.html">SSI (Server Side Includes) plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="V8.html">uWSGI V8 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="GridFS.html">The GridFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="GlusterFS.html">The GlusterFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Rados.html">The RADOS plugin</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Pty.html">The Pty plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPNEGO.html">SPNEGO authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAP.html">Configuring uWSGI with LDAP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Erlang.html">Integrating uWSGI with Erlang</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagementFlag.html">Management Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="Go.html">uWSGI Go support (1.4 only)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.18.html">uWSGI 2.0.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.1.html">uWSGI 2.0.17.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.html">uWSGI 2.0.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.16.html">uWSGI 2.0.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.15.html">uWSGI 2.0.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.14.html">uWSGI 2.0.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.1.html">uWSGI 2.0.13.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.html">uWSGI 2.0.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.12.html">uWSGI 2.0.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.2.html">uWSGI 2.0.11.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.1.html">uWSGI 2.0.11.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.html">uWSGI 2.0.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.10.html">uWSGI 2.0.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.9.html">uWSGI 2.0.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.8.html">uWSGI 2.0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.7.html">uWSGI 2.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.6.html">uWSGI 2.0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.5.html">uWSGI 2.0.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.4.html">uWSGI 2.0.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.3.html">uWSGI 2.0.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.2.html">uWSGI 2.0.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.1.html">uWSGI 2.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.html">uWSGI 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.21.html">uWSGI 1.9.21</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.20.html">uWSGI 1.9.20</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.19.html">uWSGI 1.9.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.18.html">uWSGI 1.9.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.17.html">uWSGI 1.9.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.16.html">uWSGI 1.9.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.15.html">uWSGI 1.9.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.14.html">uWSGI 1.9.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.13.html">uWSGI 1.9.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.12.html">uWSGI 1.9.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.11.html">uWSGI 1.9.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.10.html">uWSGI 1.9.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.9.html">uWSGI 1.9.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.8.html">uWSGI 1.9.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.7.html">uWSGI 1.9.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.6.html">uWSGI 1.9.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.5.html">uWSGI 1.9.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.4.html">uWSGI 1.9.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.3.html">uWSGI 1.9.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.2.html">uWSGI 1.9.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.1.html">uWSGI 1.9.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.html">uWSGI 1.9</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">uWSGI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Serving static files with uWSGI (updated to 1.9)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/StaticFiles.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="serving-static-files-with-uwsgi-updated-to-1-9">
<h1>Serving static files with uWSGI (updated to 1.9)<a class="headerlink" href="#serving-static-files-with-uwsgi-updated-to-1-9" title="제목 주소">¶</a></h1>
<p>Unfortunately you cannot live without serving static files via some protocol (HTTP, SPDY or something else).</p>
<p>Fortunately uWSGI has a wide series of options and micro-optimizations for serving static files.</p>
<p>Generally your webserver of choice (Nginx, Mongrel2, etc.) will serve static files efficiently and quickly and will simply forward dynamic requests to uWSGI backend nodes.</p>
<p>The uWSGI project has ISPs and PaaS (that is, the hosting market) as the main target, where generally you would want to avoid
generating disk I/O on a central server and have each user-dedicated area handle (and account for) that itself. More importantly still, you want to allow customers to customize the way they serve static assets without bothering your system administrator(s).</p>
<div class="section" id="mode-1-check-for-a-static-resource-before-passing-the-request-to-your-app">
<h2>Mode 1: Check for a static resource before passing the request to your app<a class="headerlink" href="#mode-1-check-for-a-static-resource-before-passing-the-request-to-your-app" title="제목 주소">¶</a></h2>
<p>This a fairly common way of managing static files in web apps. Frameworks like Ruby on Rails and many PHP apps have used this method for ages.</p>
<p>Suppose your static assets are under <code class="docutils literal notranslate"><span class="pre">/customers/foobar/app001/public</span></code>. You want to check each request has a corresponding file in that directory before passing the request to your dynamic app. The <code class="docutils literal notranslate"><span class="pre">--check-static</span></code> option is for you:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--check-static /customers/foobar/app001/public
</pre></div>
</div>
<p>If uWSGI receives a request for <code class="docutils literal notranslate"><span class="pre">/foo.png</span></code> will first check for the existence of <code class="docutils literal notranslate"><span class="pre">/customers/foobar/app001/public/foo.png</span></code> and if it is not found it will invoke your app.</p>
<p>You can specify <code class="docutils literal notranslate"><span class="pre">--check-static</span></code> multiple times to specify multiple possible root paths.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--check-static /customers/foobar/app001/public --check-static /customers/foobar/app001/static
</pre></div>
</div>
<p>uWSGI will first check for <code class="docutils literal notranslate"><span class="pre">/customers/foobar/app001/public/foo.png</span></code>; if it does not find it it will try <code class="docutils literal notranslate"><span class="pre">/customers/foobar/app001/static/foo.png</span></code> before finally delegating the request to your app.</p>
</div>
<div class="section" id="mode-2-trust-frontend-s-document-root">
<h2>Mode 2: trust frontend's DOCUMENT_ROOT<a class="headerlink" href="#mode-2-trust-frontend-s-document-root" title="제목 주소">¶</a></h2>
<p>If your frontend (a webserver, a uWSGI corerouters...) set the <code class="docutils literal notranslate"><span class="pre">DOCUMENT_ROOT</span></code> value, you can instruct uWSGI to trust it as a valid directory for checking for static files with the <code class="docutils literal notranslate"><span class="pre">--check-static-docroot</span></code> option.</p>
</div>
<div class="section" id="mode-3-using-static-file-mount-points">
<h2>Mode 3: using static file mount points<a class="headerlink" href="#mode-3-using-static-file-mount-points" title="제목 주소">¶</a></h2>
<p>A more general approach is &quot;mapping&quot; specific request prefixes to physical directories on your file system.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--static-map</span> <span class="pre">mountpoint=path</span></code> is the option for you.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map /images<span class="o">=</span>/var/www/img
</pre></div>
</div>
<p>If you get a request for <code class="docutils literal notranslate"><span class="pre">/images/logo.png</span></code> and <code class="docutils literal notranslate"><span class="pre">/var/www/img/logo.png</span></code> exists, it will be served. Otherwise your app will manage the request.</p>
<p>You can specify multiple <code class="docutils literal notranslate"><span class="pre">--static-map</span></code> options, even for the same mountpoint.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map /images<span class="o">=</span>/var/www/img --static-map /images<span class="o">=</span>/var/www/img2 --static-map /images<span class="o">=</span>/var/www/img3
</pre></div>
</div>
<p>The file will be searched in each directory until it's found, or if it's not, the request will be managed by your app.</p>
<p>In some specific cases you may want to build the internal path in a different way, retaining the original path portion of the request. The <code class="docutils literal notranslate"><span class="pre">--static-map2</span></code> option will do this.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map2 /images<span class="o">=</span>/var/www/img
</pre></div>
</div>
<p>A request for <code class="docutils literal notranslate"><span class="pre">/images/logo.png</span></code> will be looked for as <code class="docutils literal notranslate"><span class="pre">/var/www/img/images/logo.png</span></code>.</p>
<p>You can <code class="docutils literal notranslate"><span class="pre">map</span></code> (or <code class="docutils literal notranslate"><span class="pre">map2</span></code>) both directories and files.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map /images/logo.gif<span class="o">=</span>/tmp/oldlogo.gif
<span class="c1"># (psst: put favicons here)</span>
</pre></div>
</div>
</div>
<div class="section" id="mode-4-using-advanced-internal-routing">
<h2>Mode 4: using advanced internal routing<a class="headerlink" href="#mode-4-using-advanced-internal-routing" title="제목 주소">¶</a></h2>
<p>When mappings are not enough, advanced internal routing (available from 1.9) will be your last resort.</p>
<p>Thanks to the power of regular expressions you will be able to build very complex mappings.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">/static/(.*)\.png static:/var/www/images/pngs/$1/highres.png</span>
<span class="na">route</span> <span class="o">=</span> <span class="s">*\.jpg static:/var/www/always_the_same_photo.jpg</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-the-index-page">
<h2>Setting the index page<a class="headerlink" href="#setting-the-index-page" title="제목 주소">¶</a></h2>
<p>By default, requests for a &quot;directory&quot; (like / or /foo) are bypassed (if advanced internal routing is not in place).</p>
<p>If you want to map specific files to a &quot;directory&quot; request (like the venerable index.html) just use the <code class="docutils literal notranslate"><span class="pre">--static-index</span></code> option.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-index index.html --static-index index.htm --static-index home.html
</pre></div>
</div>
<p>As with the other options, the first one matching will stop the chain.</p>
</div>
<div class="section" id="mime-types">
<h2>MIME types<a class="headerlink" href="#mime-types" title="제목 주소">¶</a></h2>
<p>Your HTTP/SPDY/whateveryouwant responses for static files should always return the correct mime type for the specific file to let user agents handle them correctly.</p>
<p>By default uWSGI builds its list of MIME types from the <code class="docutils literal notranslate"><span class="pre">/etc/mime.types</span></code> file. You can load additional files with the <code class="docutils literal notranslate"><span class="pre">--mime-file</span></code>
option.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--mime-file /etc/alternatives.types --mime-file /etc/apache2/mime.types
</pre></div>
</div>
<p>All of the files will be combined into a single auto-optimizing linked list.</p>
</div>
<div class="section" id="skipping-specific-extensions">
<h2>Skipping specific extensions<a class="headerlink" href="#skipping-specific-extensions" title="제목 주소">¶</a></h2>
<p>Some platforms/languages, most-notably CGI based ones, like PHP are deployed in a very simple manner.</p>
<p>You simply drop them in the document root and they are executed whenever you call them.</p>
<p>This approach, when combined with static file serving, requires a bit of attention for avoiding your CGI/PHP/whatever to be served like static files.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--static-skip-ext</span></code> will do the trick.</p>
<p>A very common pattern on CGI and PHP deployment is this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-skip-ext .php --static-skip-ext .cgi --static-skip-ext .php4
</pre></div>
</div>
</div>
<div class="section" id="setting-the-expires-headers">
<h2>Setting the Expires headers<a class="headerlink" href="#setting-the-expires-headers" title="제목 주소">¶</a></h2>
<p>When serving static files, abusing client browser caching is the path to wisdom. By default uWSGI will add a <code class="docutils literal notranslate"><span class="pre">Last-Modified</span></code>
header to all static responses, and will honor the <code class="docutils literal notranslate"><span class="pre">If-Modified-Since</span></code> request header.</p>
<p>This might be not enough for high traffic sites. You can add automatic <code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers using one of the following options:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">--static-expires-type</span></code> will set the Expires header to the specified number of seconds for the specified MIME type.</li>
<li><code class="docutils literal notranslate"><span class="pre">--static-expires-type-mtime</span></code> is similar, but based on file modification time, not the current time.</li>
<li><code class="docutils literal notranslate"><span class="pre">--static-expires</span></code> (and <code class="docutils literal notranslate"><span class="pre">-mtime</span></code>) will set Expires header for all of the filenames (after finishing mapping to the filesystem) matching the specified regexp.</li>
<li><code class="docutils literal notranslate"><span class="pre">--static-expires-uri</span></code> (and <code class="docutils literal notranslate"><span class="pre">-mtime</span></code>) match regexps against <code class="docutils literal notranslate"><span class="pre">REQUEST_URI</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">--static-expires-path-info</span></code> (and <code class="docutils literal notranslate"><span class="pre">-mtime</span></code>) match regexps against <code class="docutils literal notranslate"><span class="pre">PATH_INFO</span></code></li>
</ul>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Expire an hour from now</span>
--static-expires-type text/html<span class="o">=</span><span class="m">3600</span>
<span class="c1"># Expire an hour from the file&#39;s modification time</span>
--static-expires-type-mtime text/html<span class="o">=</span><span class="m">3600</span>
<span class="c1"># Same as static-expires-type, but based on a regexp:</span>
--static-expires /var/www/static/foo*<span class="se">\.</span>jpg <span class="m">3600</span>
</pre></div>
</div>
</div>
<div class="section" id="transfer-modes">
<h2>Transfer modes<a class="headerlink" href="#transfer-modes" title="제목 주소">¶</a></h2>
<p>If you have developed an asynchronous/nonblocking application, serving static files directly from uWSGI is not a big problem.</p>
<p>All of the transfers are managed in the async way, so your app will not block during them.</p>
<p>In multi-process/multi-threaded modes, your processes (or threads) will be blocked during the whole transfer of the file.</p>
<p>For smaller files this is not a problem, but for the bigger one it's a great idea to offload their transfer to something else.</p>
<p>You have various ways to do this:</p>
<div class="section" id="x-sendfile">
<h3>X-Sendfile<a class="headerlink" href="#x-sendfile" title="제목 주소">¶</a></h3>
<p>If your web server supports the X-Sendfile header and has access to the file you want to send (for example it is on the same machine
of your application or can access it via NFS) you can avoid the transfer of the file from your app with the <code class="docutils literal notranslate"><span class="pre">--file-serve-mode</span> <span class="pre">x-sendfile</span></code> option.</p>
<p>With this, uWSGI will only generate response headers and the web server will be delegated to transferring the physical file.</p>
</div>
<div class="section" id="x-accel-redirect">
<h3>X-Accel-Redirect<a class="headerlink" href="#x-accel-redirect" title="제목 주소">¶</a></h3>
<p>This is currently (January 2013) supported only on Nginx. Works in the same way as X-Sendfile, the only difference
is in the option argument.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--file-serve-mode x-accel-redirect
</pre></div>
</div>
</div>
<div class="section" id="offloading">
<h3>Offloading<a class="headerlink" href="#offloading" title="제목 주소">¶</a></h3>
<p>This is the best approach if your frontend server has no access to the static files.
It uses the <a class="reference internal" href="OffloadSubsystem.html"><span class="doc">The uWSGI offloading subsystem</span></a> to delegate the file transfer to a pool of non-blocking threads.</p>
<p>Each one of these threads can manage thousands of file transfers concurrently.</p>
<p>To enable file transfer offloading just use the option <code class="docutils literal notranslate"><span class="pre">--offload-threads</span></code> specifying the number of threads to spawn (try to set it to the number of CPU cores to take advantage of SMP).</p>
</div>
</div>
<div class="section" id="gzip-uwsgi-1-9">
<h2>GZIP (uWSGI 1.9)<a class="headerlink" href="#gzip-uwsgi-1-9" title="제목 주소">¶</a></h2>
<p>uWSGI 1.9 can check for a <code class="docutils literal notranslate"><span class="pre">*.gz</span></code> variant of a static file.</p>
<p>Many users/sysadmins underestimate the CPU impact of on-the-fly Gzip encoding.</p>
<p>Compressing files every time (unless your webservers is caching them in some way) will use CPU
and you will not be able to use advanced (zero-copy) techniques like <code class="docutils literal notranslate"><span class="pre">sendfile()</span></code>. For a very loaded site (or network) this could
be a problem (especially when gzip encoding is a need for a better, more responsive user experience).</p>
<p>Although uWSGI is able to compress contents on the fly (this is used in the HTTP/HTTPS/SPDY router for example), the best approach
for serving gzipped static files is generating them &quot;manually&quot; (but please use a script, not an intern to do this), and let uWSGI
choose if it is best to serve the uncompressed or the compressed one every time.</p>
<p>In this way serving gzip content will be no different from serving standard static files (sendfile, offloading...)</p>
<p>To trigger this behavior you have various options:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">static-gzip</span> <span class="pre">&lt;regexp&gt;</span></code> checks for .gz variant for all of the requested files matching the specified regexp (the regexp is applied to the full filesystem path of the file)</li>
<li><code class="docutils literal notranslate"><span class="pre">static-gzip-dir</span> <span class="pre">&lt;dir&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">static-gzip-prefix</span> <span class="pre">&lt;prefix&gt;</span></code> checks for .gz variant for all of the files under the specified directory</li>
<li><code class="docutils literal notranslate"><span class="pre">static-gzip-ext</span> <span class="pre">&lt;ext&gt;</span></code>/<code class="docutils literal notranslate"><span class="pre">static-gzip-suffix</span> <span class="pre">&lt;suffix&gt;</span></code> check for .gz variant for all of the files with the specified extension/suffix</li>
<li><code class="docutils literal notranslate"><span class="pre">static-gzip-all</span></code> check for .gz variant for all requested static files</li>
</ul>
<p>So basically if you have <code class="docutils literal notranslate"><span class="pre">/var/www/uwsgi.c</span></code> and <code class="docutils literal notranslate"><span class="pre">/var/www/uwsgi.c.gz</span></code>, clients accepting gzip as their Content-Encoding will be transparently served the gzipped version instead.</p>
</div>
<div class="section" id="security">
<h2>Security<a class="headerlink" href="#security" title="제목 주소">¶</a></h2>
<p>Every static mapping is fully translated to the &quot;real&quot; path (so symbolic links are translated too).</p>
<p>If the resulting path is not under the one specified in the option, a security error will be triggered and the request refused.</p>
<p>If you trust your UNIX skills and know what you are doing, you can add a list of &quot;safe&quot; paths. If a translated path
is not under a configured directory but it is under a safe one, it will be served nevertheless.</p>
<p>Example:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map /foo<span class="o">=</span>/var/www/
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">/var/www/test.png</span></code> is a symlink to <code class="docutils literal notranslate"><span class="pre">/tmp/foo.png</span></code></p>
<p>After the translation of <code class="docutils literal notranslate"><span class="pre">/foo/test.png</span></code>, uWSGI will raise a security error as <code class="docutils literal notranslate"><span class="pre">/tmp/foo.png</span></code> is not under <code class="docutils literal notranslate"><span class="pre">/var/www/</span></code>.</p>
<p>Using</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-map /foo<span class="o">=</span>/var/www/ --static-safe /tmp
</pre></div>
</div>
<p>will bypass that limit.</p>
<p>You can specify multiple <code class="docutils literal notranslate"><span class="pre">--static-safe</span></code> options.</p>
</div>
<div class="section" id="caching-paths-mappings-resolutions">
<h2>Caching paths mappings/resolutions<a class="headerlink" href="#caching-paths-mappings-resolutions" title="제목 주소">¶</a></h2>
<p>One of the bottlenecks in static file serving is the constant massive amount of <code class="docutils literal notranslate"><span class="pre">stat()</span></code> syscalls.</p>
<p>You can use the uWSGI caching subsystem to store mappings from URI to filesystem paths.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>--static-cache-paths <span class="m">30</span>
</pre></div>
</div>
<p>will cache each static file translation for 30 seconds in the uWSGI cache.</p>
<p>From uWSGI 1.9 an updated caching subsystem has been added, allowing you to create multiple caches. If you want to store translations in a specific cache you can use <code class="docutils literal notranslate"><span class="pre">--static-cache-paths-name</span> <span class="pre">&lt;cachename&gt;</span></code>.</p>
</div>
<div class="section" id="bonus-trick-storing-static-files-in-the-cache">
<h2>Bonus trick: storing static files in the cache<a class="headerlink" href="#bonus-trick-storing-static-files-in-the-cache" title="제목 주소">¶</a></h2>
<p>You can directly store a static file in the uWSGI cache during startup using the option <code class="docutils literal notranslate"><span class="pre">--load-file-in-cache</span> <span class="pre">&lt;filename&gt;</span></code> (you can specify it multiple times). The content of the file will be stored under the key &lt;filename&gt;.</p>
<p>So please pay attention -- <code class="docutils literal notranslate"><span class="pre">load-file-in-cache</span> <span class="pre">./foo.png</span></code> will store the item as <code class="docutils literal notranslate"><span class="pre">./foo.png</span></code>, not its full path.</p>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="제목 주소">¶</a></h2>
<ul class="simple">
<li>The static file serving subsystem automatically honours the If-Modified-Since HTTP request header</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SNI.html" class="btn btn-neutral float-right" title="SNI - Server Name Identification (virtual hosting for SSL nodes)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="SubscriptionServer.html" class="btn btn-neutral" title="uWSGI Subscription Server" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2016, uWSGI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ko',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>