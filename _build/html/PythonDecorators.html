

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ko" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ko" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>uWSGI API - Python decorators &mdash; uWSGI 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="Pump support" href="PythonPump.html" />
    <link rel="prev" title="The uwsgi Python module" href="PythonModule.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> uWSGI
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="WSGIquickstart.html">Quickstart for Python/WSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSGIquickstart.html">Quickstart for perl/PSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RackQuickstart.html">Quickstart for ruby/Rack applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Snippets.html">Snippets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Download.html">Getting uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildSystem.html">The uWSGI build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Management.html">Managing the uWSGI server</a></li>
<li class="toctree-l1"><a class="reference internal" href="LanguagesAndPlatforms.html">Supported languages and platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupportedPlatforms.html">Supported Platforms/Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServers.html">Web server integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThingsToKnow.html">Things to know (best practices and &quot;issues&quot;) READ IT !!!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuring uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="FallbackConfig.html">Fallback configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConfigLogic.html">Configuration logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">uWSGI Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="CustomOptions.html">Defining new options for your instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParsingOrder.html">How uWSGI parses config files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vars.html">uwsgi protocol magic variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protocol.html">The uwsgi Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="AttachingDaemons.html">Managing external daemons/services</a></li>
<li class="toctree-l1"><a class="reference internal" href="MasterFIFO.html">The Master FIFO</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inetd.html">Socket activation with inetd/xinetd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Upstart.html">Running uWSGI via Upstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Systemd.html">Systemd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Circus.html">Running uWSGI instances with Circus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Embed.html">Embedding an application in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogFormat.html">Formatting uWSGI requests logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogEncoders.html">Log encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkerOverride.html">Overriding Workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThirdPartyPlugins.html">uWSGI third party plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/CachingCookbook.html">The uWSGI Caching Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/Django_and_nginx.html">Setting up Django and your web server with uWSGI and nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/dreamhost.html">Running uWSGI on Dreamhost shared hosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_python.html">Running python webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_ruby.html">Running Ruby/Rack webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ReliableFuse.html">Reliably use FUSE filesystems for uWSGI vassals (with Linux)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/DynamicProxying.html">Build a dynamic proxy using RPC and internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/GraphiteAndMetrics.html">Setting up Graphite on Ubuntu using the Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="articles/SerializingAccept.html">Serializing accept(), AKA Thundering Herd, AKA the Zeeg Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/TheArtOfGracefulReloading.html">The Art of Graceful Reloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/FunWithPerlEyetoyRaspberrypi.html">Fun with Perl, Eyetoy and RaspberryPi</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/OffloadingWebsocketsAndSSE.html">Offloading Websockets and Server-Sent Events AKA &quot;Combine them with Django safely&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/WSGIEnvBehaviour.html">WSGI env behaviour policies</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="AlarmSubsystem.html">The uWSGI alarm subsystem (from 1.3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Caching.html">The uWSGI caching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebCaching.html">WebCaching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cron.html">The uWSGI cron-like interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fastrouter.html">The uWSGI FastRouter</a></li>
<li class="toctree-l1"><a class="reference internal" href="InternalRouting.html">uWSGI internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Legion.html">The uWSGI Legion subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Locks.html">Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mules.html">uWSGI Mules</a></li>
<li class="toctree-l1"><a class="reference internal" href="OffloadSubsystem.html">The uWSGI offloading subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Queue.html">The uWSGI queue framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="RPC.html">uWSGI RPC Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="SharedArea.html">SharedArea -- share memory pages between uWSGI components</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signals.html">The uWSGI Signal Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spooler.html">The uWSGI Spooler</a></li>
<li class="toctree-l1"><a class="reference internal" href="SubscriptionServer.html">uWSGI Subscription Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="StaticFiles.html">Serving static files with uWSGI (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNI.html">SNI - Server Name Identification (virtual hosting for SSL nodes)</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeoIP.html">The GeoIP plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transformations.html">uWSGI Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebSockets.html">WebSocket support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chunked.html">The Chunked input API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Cheaper.html">The uWSGI cheaper subsystem -- adaptive process spawning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Emperor.html">The uWSGI Emperor -- multi-app deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Broodlord.html">Auto-scaling with Broodlord mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zerg.html">Zerg mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicApps.html">Adding applications dynamically</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSLScaling.html">Scaling SSL connections (uWSGI 1.9)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Capabilities.html">Setting POSIX Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cgroups.html">Running uWSGI in a Linux CGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="KSM.html">Using Linux KSM in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html">Jailing your apps using Linux Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html#the-old-way-the-namespace-option">The old way: the --namespace option</a></li>
<li class="toctree-l1"><a class="reference internal" href="FreeBSDJails.html">FreeBSD Jails</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForkptyRouter.html">The Forkpty Router</a></li>
<li class="toctree-l1"><a class="reference internal" href="TunTapRouter.html">The TunTap Router</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nagios.html">Monitoring uWSGI with Nagios</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNMP.html">The embedded SNMP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="PushingStats.html">Pushing statistics (from 1.4)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carbon.html">Integration with Graphite/Carbon</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatsServer.html">The uWSGI Stats Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Async.html">uWSGI asynchronous/non-blocking modes (updated to uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gevent.html">The Gevent loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tornado.html">The Tornado loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="uGreen.html">uGreen -- uWSGI Green Threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncio.html">The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Apache.html">Apache support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cherokee.html">Cherokee support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTP.html">Native HTTP support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTPS.html">HTTPS 지원 (1.3 버전부터)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPDY.html">The SPDY router (uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lighttpd.html">Lighttpd support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mongrel2.html">Attaching uWSGI to Mongrel2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nginx.html">Nginx support</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html">Using OpenBSD httpd as proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html#notes">Notes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Python.html">Python support</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PythonModule.html">The uwsgi Python module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">uWSGI API - Python decorators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-a-django-session-cleaner-and-video-encoder">Example: a Django session cleaner and video encoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-web2py-spooler-timer">Example: web2py + spooler + timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-uwsgidecorators">uwsgidecorators API reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PythonPump.html">Pump support</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tracebacker.html">Python Tracebacker</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonModuleAlias.html">Aliasing Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#application-dictionary">Application dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#virtualenv-support">Virtualenv support</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#python-3">Python 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#paste-support">Paste support</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#pecan-support">Pecan support</a></li>
<li class="toctree-l2"><a class="reference internal" href="Python.html#using-the-django-uwsgi-django-app">Using the django-uwsgi Django app</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PyPy.html">The PyPy plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="PHP.html">Running PHP scripts in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Perl.html">uWSGI Perl support (PSGI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ruby.html">Ruby support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lua.html">Using Lua/WSAPI with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="JVM.html">JVM in the uWSGI server (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mono.html">The Mono ASP.NET plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="CGI.html">Running CGI scripts on uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCCGO.html">The GCCGO plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Symcall.html">The Symcall plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLT.html">The XSLT plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSI.html">SSI (Server Side Includes) plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="V8.html">uWSGI V8 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="GridFS.html">The GridFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="GlusterFS.html">The GlusterFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Rados.html">The RADOS plugin</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Pty.html">The Pty plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPNEGO.html">SPNEGO authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAP.html">Configuring uWSGI with LDAP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Erlang.html">Integrating uWSGI with Erlang</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagementFlag.html">Management Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="Go.html">uWSGI Go support (1.4 only)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.18.html">uWSGI 2.0.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.1.html">uWSGI 2.0.17.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.html">uWSGI 2.0.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.16.html">uWSGI 2.0.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.15.html">uWSGI 2.0.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.14.html">uWSGI 2.0.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.1.html">uWSGI 2.0.13.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.html">uWSGI 2.0.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.12.html">uWSGI 2.0.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.2.html">uWSGI 2.0.11.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.1.html">uWSGI 2.0.11.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.html">uWSGI 2.0.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.10.html">uWSGI 2.0.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.9.html">uWSGI 2.0.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.8.html">uWSGI 2.0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.7.html">uWSGI 2.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.6.html">uWSGI 2.0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.5.html">uWSGI 2.0.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.4.html">uWSGI 2.0.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.3.html">uWSGI 2.0.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.2.html">uWSGI 2.0.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.1.html">uWSGI 2.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.html">uWSGI 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.21.html">uWSGI 1.9.21</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.20.html">uWSGI 1.9.20</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.19.html">uWSGI 1.9.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.18.html">uWSGI 1.9.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.17.html">uWSGI 1.9.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.16.html">uWSGI 1.9.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.15.html">uWSGI 1.9.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.14.html">uWSGI 1.9.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.13.html">uWSGI 1.9.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.12.html">uWSGI 1.9.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.11.html">uWSGI 1.9.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.10.html">uWSGI 1.9.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.9.html">uWSGI 1.9.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.8.html">uWSGI 1.9.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.7.html">uWSGI 1.9.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.6.html">uWSGI 1.9.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.5.html">uWSGI 1.9.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.4.html">uWSGI 1.9.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.3.html">uWSGI 1.9.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.2.html">uWSGI 1.9.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.1.html">uWSGI 1.9.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.html">uWSGI 1.9</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">uWSGI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Python.html">Python support</a> &raquo;</li>
        
      <li>uWSGI API - Python decorators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/PythonDecorators.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uwsgi-api-python-decorators">
<h1>uWSGI API - Python decorators<a class="headerlink" href="#uwsgi-api-python-decorators" title="제목 주소">¶</a></h1>
<p><a class="reference internal" href="PythonModule.html"><span class="doc">The uWSGI API</span></a> is very low-level, as it must be language-independent.</p>
<p>That said, being too low-level is not a Good Thing for many languages, such as Python.</p>
<p>Decorators are, in our humble opinion, one of the more kick-ass features of Python, so in the uWSGI source tree you will find a module exporting a bunch of decorators that cover a good part of the uWSGI API.</p>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="제목 주소">¶</a></h2>
<p>Signal-based decorators execute the signal handler in the first available worker.
If you have enabled the spooler you can execute the signal handlers in it, leaving workers free to manage normal requests. Simply pass <code class="docutils literal notranslate"><span class="pre">target='spooler'</span></code> to the decorator.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@timer</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;spooler&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">signum</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-a-django-session-cleaner-and-video-encoder">
<h2>Example: a Django session cleaner and video encoder<a class="headerlink" href="#example-a-django-session-cleaner-and-video-encoder" title="제목 주소">¶</a></h2>
<p>Let's define a <code class="file docutils literal notranslate"><span class="pre">task.py</span></code> module and put it in the Django project directory.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">uwsgidecorators</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">django.contrib.sessions.models</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="nd">@cron</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">clear_django_session</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;it&#39;s 2:40 in the morning: clearing django sessions&quot;</span><span class="p">)</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

<span class="nd">@spool</span>
<span class="k">def</span> <span class="nf">encode_video</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;ffmpeg -i </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> image</span><span class="si">%%</span><span class="s2">d.jpg&quot;</span> <span class="o">%</span> <span class="n">arguments</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The session cleaner will be executed every day at 2:40, to enqueue a video encoding we simply need to spool it from somewhere else.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">task</span> <span class="kn">import</span> <span class="n">encode_video</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># launching video encoding</span>
    <span class="n">encode_video</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;video_filename&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s1">&#39;enqueued.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now run uWSGI with the spooler enabled:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="c1">; a couple of placeholder</span>
<span class="na">django_projects_dir</span> <span class="o">=</span> <span class="s">/var/www/apps</span>
<span class="na">my_project</span> <span class="o">=</span> <span class="s">foobar</span>
<span class="c1">; chdir to app project dir and set pythonpath</span>
<span class="na">chdir</span> <span class="o">=</span> <span class="s">%(django_projects_dir)/%(my_project)</span>
<span class="na">pythonpath</span> <span class="o">=</span> <span class="s">%(django_projects_dir)</span>
<span class="c1">; load django</span>
<span class="na">module</span> <span class="o">=</span> <span class="s">django.core.handlers:WSGIHandler()</span>
<span class="na">env</span> <span class="o">=</span> <span class="s">DJANGO_SETTINGS_MODULE=%(my_project).settings</span>
<span class="c1">; enable master</span>
<span class="na">master</span> <span class="o">=</span> <span class="s">true</span>
<span class="c1">; 4 processes should be enough</span>
<span class="na">processes</span> <span class="o">=</span> <span class="s">4</span>
<span class="c1">; enable the spooler (the mytasks dir must exist!)</span>
<span class="na">spooler</span> <span class="o">=</span> <span class="s">%(chdir)/mytasks</span>
<span class="c1">; load the task.py module</span>
<span class="na">import</span> <span class="o">=</span> <span class="s">task</span>
<span class="c1">; bind on a tcp socket</span>
<span class="na">socket</span> <span class="o">=</span> <span class="s">127.0.0.1:3031</span>
</pre></div>
</div>
<p>The only especially relevant option is the <code class="docutils literal notranslate"><span class="pre">import</span></code> one. It works in the same way as <code class="docutils literal notranslate"><span class="pre">module</span></code> but skips the WSGI callable search.
You can use it to preload modules before the loading of WSGI apps. You can specify an unlimited number of '''import''' directives.</p>
</div>
<div class="section" id="example-web2py-spooler-timer">
<h2>Example: web2py + spooler + timer<a class="headerlink" href="#example-web2py-spooler-timer" title="제목 주소">¶</a></h2>
<p>First of all define your spooler and timer functions (we will call it :file:<code class="docutils literal notranslate"><span class="pre">mytasks.py</span></code>)</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">uwsgidecorators</span> <span class="kn">import</span> <span class="o">*</span>

<span class="nd">@spool</span>
<span class="k">def</span> <span class="nf">a_long_task</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<span class="nd">@spool</span>
<span class="k">def</span> <span class="nf">a_longer_task</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;longer.....&quot;</span><span class="p">)</span>

<span class="nd">@timer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">three_seconds</span><span class="p">(</span><span class="n">signum</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;3 seconds elapsed&quot;</span><span class="p">)</span>

<span class="nd">@timer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;spooler&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ten_seconds_in_the_spooler</span><span class="p">(</span><span class="n">signum</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;10 seconds elapsed in the spooler&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now run web2py.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>uwsgi --socket :3031 --spooler myspool --master --processes <span class="m">4</span> --import mytasks --module web2py.wsgihandler
</pre></div>
</div>
<p>As soon as the application is loaded, you will see the 2 timers running in your logs.</p>
<p>Now we want to enqueue tasks from our web2py controllers.</p>
<p>Edit one of them and add</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mytasks</span> <span class="c1"># be sure mytasks is importable!</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">():</span> <span class="c1"># this is a web2py action</span>
    <span class="n">mytasks</span><span class="o">.</span><span class="n">a_long_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Task enqueued&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="module-uwsgidecorators">
<span id="uwsgidecorators-api-reference"></span><h2>uwsgidecorators API reference<a class="headerlink" href="#module-uwsgidecorators" title="제목 주소">¶</a></h2>
<dl class="function">
<dt id="uwsgidecorators.postfork">
<code class="descclassname">uwsgidecorators.</code><code class="descname">postfork</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.postfork" title="정의 주소">¶</a></dt>
<dd><p>uWSGI is a preforking (or &quot;fork-abusing&quot;) server, so you might need to execute a fixup task after each <code class="docutils literal notranslate"><span class="pre">fork()</span></code>. The <code class="docutils literal notranslate"><span class="pre">postfork</span></code> decorator is just the ticket.
You can declare multiple <code class="docutils literal notranslate"><span class="pre">postfork</span></code> tasks. Each decorated function will be executed in sequence after each <code class="docutils literal notranslate"><span class="pre">fork()</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@postfork</span>
<span class="k">def</span> <span class="nf">reconnect_to_db</span><span class="p">():</span>
    <span class="n">myfoodb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="nd">@postfork</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.spool">
<code class="descclassname">uwsgidecorators.</code><code class="descname">spool</code><span class="sig-paren">(</span><em>func</em>, <em>pass_arguments=False</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.spool" title="정의 주소">¶</a></dt>
<dd><p>The uWSGI <a class="reference internal" href="Spooler.html"><span class="doc">spooler</span></a> can be very useful. Compared to
Celery or other queues it is very &quot;raw&quot;. The <code class="docutils literal notranslate"><span class="pre">spool</span></code> decorator will
help!</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spool</span>
<span class="k">def</span> <span class="nf">a_long_long_task</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

<span class="nd">@spool</span>
<span class="k">def</span> <span class="nf">a_longer_task</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># enqueue the tasks</span>
<span class="n">a_long_long_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">hello</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>
<span class="n">a_longer_task</span><span class="o">.</span><span class="n">spool</span><span class="p">({</span><span class="s1">&#39;pippo&#39;</span><span class="p">:</span><span class="s1">&#39;pluto&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, only <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type arguments are allowed. See below for
another way of passing arguments.</p>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pass_arguments</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, arguments can be of any type
supported by the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code> module. The following arguments have
a special meaning:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">spooler</span></code>: specify the <strong>absolute</strong> path of the spooler that has to
manage this task</li>
<li><code class="docutils literal notranslate"><span class="pre">at</span></code>: unix time at which the task must be executed (read: the task
will not be run until the <code class="docutils literal notranslate"><span class="pre">at</span></code> time is passed)</li>
<li><code class="docutils literal notranslate"><span class="pre">priority</span></code>: this will be the subdirectory in the spooler directory
in which the task will be placed, you can use that trick to give
a good-enough prioritization to tasks (for better approach use
multiple spoolers)</li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, the special arguments <code class="docutils literal notranslate"><span class="pre">spooler</span></code>, <code class="docutils literal notranslate"><span class="pre">at</span></code>,
<code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code> <strong>must</strong> be <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spool</span><span class="p">(</span><span class="n">pass_arguments</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">some_task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># enqueue the task</span>
<span class="n">some_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">],</span> <span class="n">func</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1497023151</span><span class="p">))</span>
</pre></div>
</div>
<p>The functions will automatically return <code class="docutils literal notranslate"><span class="pre">uwsgi.SPOOL_OK</span></code> so they will
be executed one time independently by their return status.</p>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.spoolforever">
<code class="descclassname">uwsgidecorators.</code><code class="descname">spoolforever</code><span class="sig-paren">(</span><em>func</em>, <em>pass_arguments=False</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.spoolforever" title="정의 주소">¶</a></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">spoolforever</span></code> when you want to continuously execute a spool task.
A <code class="docutils literal notranslate"><span class="pre">&#64;spoolforever</span></code> task will always return <code class="docutils literal notranslate"><span class="pre">uwsgi.SPOOL_RETRY</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spoolforever</span>
<span class="k">def</span> <span class="nf">a_longer_task</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># enqueue the task</span>
<span class="n">a_longer_task</span><span class="o">.</span><span class="n">spool</span><span class="p">({</span><span class="s1">&#39;pippo&#39;</span><span class="p">:</span><span class="s1">&#39;pluto&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, only <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type arguments are allowed. See below for
another way of passing arguments.</p>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pass_arguments</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, arguments can be of any type
supported by the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code> module. The following arguments have
a special meaning:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">spooler</span></code>: specify the <strong>absolute</strong> path of the spooler that has to
manage this task</li>
<li><code class="docutils literal notranslate"><span class="pre">at</span></code>: unix time at which the task must be executed (read: the task
will not be run until the <code class="docutils literal notranslate"><span class="pre">at</span></code> time is passed)</li>
<li><code class="docutils literal notranslate"><span class="pre">priority</span></code>: this will be the subdirectory in the spooler directory
in which the task will be placed, you can use that trick to give
a good-enough prioritization to tasks (for better approach use
multiple spoolers)</li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, the special arguments <code class="docutils literal notranslate"><span class="pre">spooler</span></code>, <code class="docutils literal notranslate"><span class="pre">at</span></code>,
<code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code> <strong>must</strong> be <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spoolforever</span><span class="p">(</span><span class="n">pass_arguments</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">a_longer_task</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># enqueue the task</span>
<span class="n">a_longer_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="s1">&#39;pluto&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.spoolraw">
<code class="descclassname">uwsgidecorators.</code><code class="descname">spoolraw</code><span class="sig-paren">(</span><em>func</em>, <em>pass_arguments=False</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.spoolraw" title="정의 주소">¶</a></dt>
<dd><p>Advanced users may want to control the return value of a task.</p>
<blockquote>
<div><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spoolraw</span>
<span class="k">def</span> <span class="nf">a_controlled_task</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">SPOOL_OK</span>
    <span class="k">return</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">SPOOL_RETRY</span>

<span class="n">a_controlled_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, only <code class="docutils literal notranslate"><span class="pre">bytes</span></code> type arguments are allowed. See below for
another way of passing arguments.</p>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pass_arguments</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, arguments can be of any type
supported by the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code> module. The following arguments have
a special meaning:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">spooler</span></code>: specify the <strong>absolute</strong> path of the spooler that has to
manage this task</li>
<li><code class="docutils literal notranslate"><span class="pre">at</span></code>: unix time at which the task must be executed (read: the task
will not be run until the <code class="docutils literal notranslate"><span class="pre">at</span></code> time is passed)</li>
<li><code class="docutils literal notranslate"><span class="pre">priority</span></code>: this will be the subdirectory in the spooler directory
in which the task will be placed, you can use that trick to give
a good-enough prioritization to tasks (for better approach use
multiple spoolers)</li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">경고</p>
<p class="last">On Python3, the special arguments <code class="docutils literal notranslate"><span class="pre">spooler</span></code>, <code class="docutils literal notranslate"><span class="pre">at</span></code>,
<code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code> <strong>must</strong> be <code class="docutils literal notranslate"><span class="pre">bytes</span></code>.</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@spoolraw</span><span class="p">(</span><span class="n">pass_arguments</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">a_controlled_task</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">SPOOL_OK</span>
    <span class="k">return</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">SPOOL_RETRY</span>

<span class="n">a_controlled_task</span><span class="o">.</span><span class="n">spool</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.rpc">
<code class="descclassname">uwsgidecorators.</code><code class="descname">rpc</code><span class="sig-paren">(</span><em>&quot;name&quot;</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.rpc" title="정의 주소">¶</a></dt>
<dd><p>uWSGI <a class="reference internal" href="RPC.html"><span class="doc">uWSGI RPC Stack</span></a> is the fastest way to remotely call functions in applications hosted in uWSGI instances. You can easily define exported functions with the &#64;rpc decorator.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@rpc</span><span class="p">(</span><span class="s1">&#39;helloworld&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ciao_mondo_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.signal">
<code class="descclassname">uwsgidecorators.</code><code class="descname">signal</code><span class="sig-paren">(</span><em>num)(func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.signal" title="정의 주소">¶</a></dt>
<dd><p>You can register signals for the <a class="reference internal" href="Signals.html"><span class="doc">signal framework</span></a> in one shot.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@signal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_signal</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;i am signal </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.timer">
<code class="descclassname">uwsgidecorators.</code><code class="descname">timer</code><span class="sig-paren">(</span><em>interval</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.timer" title="정의 주소">¶</a></dt>
<dd><p>Execute a function at regular intervals.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@timer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">three_seconds</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;3 seconds elapsed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.rbtimer">
<code class="descclassname">uwsgidecorators.</code><code class="descname">rbtimer</code><span class="sig-paren">(</span><em>interval</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.rbtimer" title="정의 주소">¶</a></dt>
<dd><p>Works like &#64;timer but using red black timers.</p>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.cron">
<code class="descclassname">uwsgidecorators.</code><code class="descname">cron</code><span class="sig-paren">(</span><em>min</em>, <em>hour</em>, <em>day</em>, <em>mon</em>, <em>wday</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.cron" title="정의 주소">¶</a></dt>
<dd><p>Easily register functions for the <span class="xref std std-doc">CronInterface</span>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@cron</span><span class="p">(</span><span class="mi">59</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">execute_me_at_three_and_fiftynine</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;it&#39;s 3:59 in the morning&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Since 1.2, a new syntax is supported to simulate <code class="docutils literal notranslate"><span class="pre">crontab</span></code>-like intervals (every Nth minute, etc.). <code class="docutils literal notranslate"><span class="pre">*/5</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span> <span class="pre">*</span></code> can be specified in uWSGI like thus:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@cron</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">execute_me_every_five_min</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;5 minutes, what a long time!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.filemon">
<code class="descclassname">uwsgidecorators.</code><code class="descname">filemon</code><span class="sig-paren">(</span><em>path</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.filemon" title="정의 주소">¶</a></dt>
<dd><p>Execute a function every time a file/directory is modified.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@filemon</span><span class="p">(</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">tmp_has_been_modified</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;/tmp directory has been modified. Great magic is afoot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.erlang">
<code class="descclassname">uwsgidecorators.</code><code class="descname">erlang</code><span class="sig-paren">(</span><em>process_name</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.erlang" title="정의 주소">¶</a></dt>
<dd><p>Map a function as an <a class="reference internal" href="Erlang.html"><span class="doc">Erlang</span></a> process.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@erlang</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.thread">
<code class="descclassname">uwsgidecorators.</code><code class="descname">thread</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.thread" title="정의 주소">¶</a></dt>
<dd><p>Mark function to be executed in a separate thread.</p>
<div class="admonition important">
<p class="first admonition-title">중요</p>
<p class="last">Threading must be enabled in uWSGI with the <code class="docutils literal notranslate"><span class="pre">enable-threads</span></code> or <code class="docutils literal notranslate"><span class="pre">threads</span> <span class="pre">&lt;n&gt;</span></code> option.</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@thread</span>
<span class="k">def</span> <span class="nf">a_running_thread</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;i am a no-args thread&quot;</span><span class="p">)</span>

<span class="nd">@thread</span>
<span class="k">def</span> <span class="nf">a_running_thread_with_args</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello </span><span class="si">%s</span><span class="s2"> (from arged-thread)&quot;</span> <span class="o">%</span> <span class="n">who</span><span class="p">)</span>

<span class="n">a_running_thread</span><span class="p">()</span>
<span class="n">a_running_thread_with_args</span><span class="p">(</span><span class="s2">&quot;uWSGI&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You may also combine <code class="docutils literal notranslate"><span class="pre">&#64;thread</span></code> with <code class="docutils literal notranslate"><span class="pre">&#64;postfork</span></code> to spawn the postfork handler in a new thread in the freshly spawned worker.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@postfork</span>
<span class="nd">@thread</span>
<span class="k">def</span> <span class="nf">a_post_fork_thread</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello from a thread in worker </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">uwsgi</span><span class="o">.</span><span class="n">worker_id</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.lock">
<code class="descclassname">uwsgidecorators.</code><code class="descname">lock</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.lock" title="정의 주소">¶</a></dt>
<dd><p>This decorator will execute a function in fully locked environment, making it impossible for other workers or threads (or the master, if you're foolish or brave enough) to run it simultaneously.
Obviously this may be combined with &#64;postfork.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@lock</span>
<span class="k">def</span> <span class="nf">dangerous_op</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Concurrency is for fools!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.mulefunc">
<code class="descclassname">uwsgidecorators.</code><code class="descname">mulefunc</code><span class="sig-paren">(</span><span class="optional">[</span><em>mulespec</em>, <span class="optional">]</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.mulefunc" title="정의 주소">¶</a></dt>
<dd><p>Offload the execution of the function to a <a class="reference internal" href="Mules.html"><span class="doc">mule</span></a>. When the offloaded function is called, it will return immediately and execution is delegated to a mule.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@mulefunc</span>
<span class="k">def</span> <span class="nf">i_am_an_offloaded_function</span><span class="p">(</span><span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">argument1</span><span class="p">,</span><span class="n">argument2</span>
</pre></div>
</div>
<p>You may also specify a mule ID or mule farm to run the function on. Please remember to register your function with a uwsgi import configuration option.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@mulefunc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">on_three</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;I&#39;m running on mule 3.&quot;</span>

<span class="nd">@mulefunc</span><span class="p">(</span><span class="s1">&#39;old_mcdonalds_farm&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">on_mcd</span><span class="p">():</span>
    <span class="k">print</span> <span class="s2">&quot;I&#39;m running on a mule on Old McDonalds&#39; farm.&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="uwsgidecorators.harakiri">
<code class="descclassname">uwsgidecorators.</code><code class="descname">harakiri</code><span class="sig-paren">(</span><em>time</em>, <em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#uwsgidecorators.harakiri" title="정의 주소">¶</a></dt>
<dd><p>Starting from uWSGI 1.3-dev, a customizable secondary <a class="reference internal" href="Glossary.html#term-harakiri"><span class="xref std std-term">harakiri</span></a> subsystem has been added. You can use this decorator to kill a worker if the given call is taking too long.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@harakiri</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">slow_function</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span>
            <span class="k">pass</span>

<span class="c1"># or the alternative lower level api</span>

<span class="n">uwsgi</span><span class="o">.</span><span class="n">set_user_harakiri</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># you have 30 seconds. fight!</span>
<span class="n">slow_function</span><span class="p">()</span>
<span class="n">uwsgi</span><span class="o">.</span><span class="n">set_user_harakiri</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># clear the timer, all is well</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PythonPump.html" class="btn btn-neutral float-right" title="Pump support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="PythonModule.html" class="btn btn-neutral" title="The uwsgi Python module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2016, uWSGI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ko',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>