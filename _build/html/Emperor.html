

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ko" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ko" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The uWSGI Emperor -- multi-app deployment &mdash; uWSGI 2.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="Imperial monitors" href="ImperialMonitors.html" />
    <link rel="prev" title="The uWSGI cheaper subsystem -- adaptive process spawning" href="Cheaper.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> uWSGI
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="WSGIquickstart.html">Quickstart for Python/WSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSGIquickstart.html">Quickstart for perl/PSGI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RackQuickstart.html">Quickstart for ruby/Rack applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Snippets.html">Snippets</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Download.html">Getting uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installing uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildSystem.html">The uWSGI build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Management.html">Managing the uWSGI server</a></li>
<li class="toctree-l1"><a class="reference internal" href="LanguagesAndPlatforms.html">Supported languages and platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupportedPlatforms.html">Supported Platforms/Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServers.html">Web server integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThingsToKnow.html">Things to know (best practices and &quot;issues&quot;) READ IT !!!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuring uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="FallbackConfig.html">Fallback configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConfigLogic.html">Configuration logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">uWSGI Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="CustomOptions.html">Defining new options for your instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="ParsingOrder.html">How uWSGI parses config files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Vars.html">uwsgi protocol magic variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="Protocol.html">The uwsgi Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="AttachingDaemons.html">Managing external daemons/services</a></li>
<li class="toctree-l1"><a class="reference internal" href="MasterFIFO.html">The Master FIFO</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inetd.html">Socket activation with inetd/xinetd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Upstart.html">Running uWSGI via Upstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Systemd.html">Systemd</a></li>
<li class="toctree-l1"><a class="reference internal" href="Circus.html">Running uWSGI instances with Circus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Embed.html">Embedding an application in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogFormat.html">Formatting uWSGI requests logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogEncoders.html">Log encoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkerOverride.html">Overriding Workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="ThirdPartyPlugins.html">uWSGI third party plugins</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/CachingCookbook.html">The uWSGI Caching Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/Django_and_nginx.html">Setting up Django and your web server with uWSGI and nginx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/dreamhost.html">Running uWSGI on Dreamhost shared hosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_python.html">Running python webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/heroku_ruby.html">Running Ruby/Rack webapps on Heroku with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ReliableFuse.html">Reliably use FUSE filesystems for uWSGI vassals (with Linux)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/DynamicProxying.html">Build a dynamic proxy using RPC and internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/GraphiteAndMetrics.html">Setting up Graphite on Ubuntu using the Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="articles/SerializingAccept.html">Serializing accept(), AKA Thundering Herd, AKA the Zeeg Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/TheArtOfGracefulReloading.html">The Art of Graceful Reloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/FunWithPerlEyetoyRaspberrypi.html">Fun with Perl, Eyetoy and RaspberryPi</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/OffloadingWebsocketsAndSSE.html">Offloading Websockets and Server-Sent Events AKA &quot;Combine them with Django safely&quot;</a></li>
<li class="toctree-l1"><a class="reference internal" href="articles/WSGIEnvBehaviour.html">WSGI env behaviour policies</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="AlarmSubsystem.html">The uWSGI alarm subsystem (from 1.3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Caching.html">The uWSGI caching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebCaching.html">WebCaching framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cron.html">The uWSGI cron-like interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fastrouter.html">The uWSGI FastRouter</a></li>
<li class="toctree-l1"><a class="reference internal" href="InternalRouting.html">uWSGI internal routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Legion.html">The uWSGI Legion subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Locks.html">Locks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mules.html">uWSGI Mules</a></li>
<li class="toctree-l1"><a class="reference internal" href="OffloadSubsystem.html">The uWSGI offloading subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Queue.html">The uWSGI queue framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="RPC.html">uWSGI RPC Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="SharedArea.html">SharedArea -- share memory pages between uWSGI components</a></li>
<li class="toctree-l1"><a class="reference internal" href="Signals.html">The uWSGI Signal Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spooler.html">The uWSGI Spooler</a></li>
<li class="toctree-l1"><a class="reference internal" href="SubscriptionServer.html">uWSGI Subscription Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="StaticFiles.html">Serving static files with uWSGI (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNI.html">SNI - Server Name Identification (virtual hosting for SSL nodes)</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeoIP.html">The GeoIP plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Transformations.html">uWSGI Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebSockets.html">WebSocket support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chunked.html">The Chunked input API</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Cheaper.html">The uWSGI cheaper subsystem -- adaptive process spawning</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The uWSGI Emperor -- multi-app deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html">Imperial monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="EmperorProtocol.html">The Emperor protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="OnDemandVassals.html">On demand vassals (socket activation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#special-configuration-variables">Special configuration variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#passing-configuration-parameters-to-all-vassals">Passing configuration parameters to all vassals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tyrant-mode-secure-multi-user-hosting">Tyrant mode (secure multi-user hosting)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tyrant-mode-for-paranoid-sysadmins-linux-only">Tyrant mode for paranoid sysadmins (Linux only)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loyalty">Loyalty</a></li>
<li class="toctree-l2"><a class="reference internal" href="#throttling">Throttling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blacklist-system">Blacklist system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#heartbeat-system">Heartbeat system</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-linux-namespaces-for-vassals">Using Linux namespaces for vassals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-imperial-bureau-of-statistics">The Imperial Bureau of Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-non-uwsgi-apps-or-using-alternative-uwsgis-as-vassals">Running non-uWSGI apps or using alternative uWSGIs as vassals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrating-the-emperor-with-the-fastrouter">Integrating the Emperor with the FastRouter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#todo">Todo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Broodlord.html">Auto-scaling with Broodlord mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="Zerg.html">Zerg mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicApps.html">Adding applications dynamically</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSLScaling.html">Scaling SSL connections (uWSGI 1.9)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Capabilities.html">Setting POSIX Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cgroups.html">Running uWSGI in a Linux CGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="KSM.html">Using Linux KSM in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html">Jailing your apps using Linux Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Namespaces.html#the-old-way-the-namespace-option">The old way: the --namespace option</a></li>
<li class="toctree-l1"><a class="reference internal" href="FreeBSDJails.html">FreeBSD Jails</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForkptyRouter.html">The Forkpty Router</a></li>
<li class="toctree-l1"><a class="reference internal" href="TunTapRouter.html">The TunTap Router</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nagios.html">Monitoring uWSGI with Nagios</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNMP.html">The embedded SNMP server</a></li>
<li class="toctree-l1"><a class="reference internal" href="PushingStats.html">Pushing statistics (from 1.4)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Carbon.html">Integration with Graphite/Carbon</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatsServer.html">The uWSGI Stats Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">The Metrics subsystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Async.html">uWSGI asynchronous/non-blocking modes (updated to uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gevent.html">The Gevent loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tornado.html">The Tornado loop engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="uGreen.html">uGreen -- uWSGI Green Threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncio.html">The asyncio loop engine (CPython &gt;= 3.4, uWSGI &gt;= 2.0.4)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Apache.html">Apache support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cherokee.html">Cherokee support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTP.html">Native HTTP support</a></li>
<li class="toctree-l1"><a class="reference internal" href="HTTPS.html">HTTPS 지원 (1.3 버전부터)</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPDY.html">The SPDY router (uWSGI 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lighttpd.html">Lighttpd support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mongrel2.html">Attaching uWSGI to Mongrel2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nginx.html">Nginx support</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html">Using OpenBSD httpd as proxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenBSDhttpd.html#notes">Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python support</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyPy.html">The PyPy plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="PHP.html">Running PHP scripts in uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Perl.html">uWSGI Perl support (PSGI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ruby.html">Ruby support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lua.html">Using Lua/WSAPI with uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="JVM.html">JVM in the uWSGI server (updated to 1.9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mono.html">The Mono ASP.NET plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="CGI.html">Running CGI scripts on uWSGI</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCCGO.html">The GCCGO plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Symcall.html">The Symcall plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLT.html">The XSLT plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SSI.html">SSI (Server Side Includes) plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="V8.html">uWSGI V8 support</a></li>
<li class="toctree-l1"><a class="reference internal" href="GridFS.html">The GridFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="GlusterFS.html">The GlusterFS plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Rados.html">The RADOS plugin</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Pty.html">The Pty plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPNEGO.html">SPNEGO authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAP.html">Configuring uWSGI with LDAP</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Erlang.html">Integrating uWSGI with Erlang</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagementFlag.html">Management Flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="Go.html">uWSGI Go support (1.4 only)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.18.html">uWSGI 2.0.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.1.html">uWSGI 2.0.17.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.17.html">uWSGI 2.0.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.16.html">uWSGI 2.0.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.15.html">uWSGI 2.0.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.14.html">uWSGI 2.0.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.1.html">uWSGI 2.0.13.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.13.html">uWSGI 2.0.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.12.html">uWSGI 2.0.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.2.html">uWSGI 2.0.11.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.1.html">uWSGI 2.0.11.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.11.html">uWSGI 2.0.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.10.html">uWSGI 2.0.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.9.html">uWSGI 2.0.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.8.html">uWSGI 2.0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.7.html">uWSGI 2.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.6.html">uWSGI 2.0.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.5.html">uWSGI 2.0.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.4.html">uWSGI 2.0.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.3.html">uWSGI 2.0.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.2.html">uWSGI 2.0.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.1.html">uWSGI 2.0.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-2.0.html">uWSGI 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.21.html">uWSGI 1.9.21</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.20.html">uWSGI 1.9.20</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.19.html">uWSGI 1.9.19</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.18.html">uWSGI 1.9.18</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.17.html">uWSGI 1.9.17</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.16.html">uWSGI 1.9.16</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.15.html">uWSGI 1.9.15</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.14.html">uWSGI 1.9.14</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.13.html">uWSGI 1.9.13</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.12.html">uWSGI 1.9.12</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.11.html">uWSGI 1.9.11</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.10.html">uWSGI 1.9.10</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.9.html">uWSGI 1.9.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.8.html">uWSGI 1.9.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.7.html">uWSGI 1.9.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.6.html">uWSGI 1.9.6</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.5.html">uWSGI 1.9.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.4.html">uWSGI 1.9.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.3.html">uWSGI 1.9.3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.2.html">uWSGI 1.9.2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.1.html">uWSGI 1.9.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog-1.9.html">uWSGI 1.9</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">uWSGI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The uWSGI Emperor -- multi-app deployment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Emperor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-uwsgi-emperor-multi-app-deployment">
<h1>The uWSGI Emperor -- multi-app deployment<a class="headerlink" href="#the-uwsgi-emperor-multi-app-deployment" title="제목 주소">¶</a></h1>
<p>If you need to deploy a big number of apps on a single server, or a group of
servers, the Emperor mode is just the ticket.  It is a special uWSGI instance
that will monitor specific events and will spawn/stop/reload instances (known
as <span class="xref std std-term">vassals</span>, when managed by an Emperor) on demand.</p>
<p>By default the Emperor will scan specific directories for supported (.ini,
.xml, .yml, .json, etc.) uWSGI configuration files, but it is extensible using
<span class="xref std std-term">imperial monitor</span> plugins.  The <code class="docutils literal notranslate"><span class="pre">dir://</span></code> and <code class="docutils literal notranslate"><span class="pre">glob://</span></code> plugins are
embedded in the core, so they need not be loaded, and are automatically
detected. The <code class="docutils literal notranslate"><span class="pre">dir://</span></code> plugin is the default.</p>
<ul class="simple">
<li>Whenever an imperial monitor detects a new configuration file, a new uWSGI instance will be spawned with that configuration.</li>
<li>Whenever a configuration file is modified (its modification time changed, so <code class="docutils literal notranslate"><span class="pre">touch</span> <span class="pre">--no-dereference</span></code> may be your friend), the corresponding app will be reloaded.</li>
<li>Whenever a config file is removed, the corresponding app will be stopped.</li>
<li>If the emperor dies, all the vassals die.</li>
<li>If a vassal dies for any reason, the emperor will respawn it.</li>
</ul>
<p>Multiple sources of configuration may be monitored by specifying <code class="docutils literal notranslate"><span class="pre">--emperor</span></code> multiple times.</p>
<div class="admonition seealso">
<p class="first admonition-title">더 보기</p>
<p class="last">See <a class="reference internal" href="ImperialMonitors.html"><span class="doc">Imperial monitors</span></a> for a list of the Imperial Monitor plugins
shipped with uWSGI and how to use them.</p>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ImperialMonitors.html">Imperial monitors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#dir-scan-a-directory-for-uwsgi-config-files"><code class="docutils literal notranslate"><span class="pre">dir://</span></code> -- scan a directory for uWSGI config files</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#glob-monitor-a-shell-pattern"><code class="docutils literal notranslate"><span class="pre">glob://</span></code> -- monitor a shell pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#pg-scan-a-postgresql-table-for-configuration"><code class="docutils literal notranslate"><span class="pre">pg://</span></code> -- scan a PostgreSQL table for configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#mongodb-scan-mongodb-collections-for-configuration"><code class="docutils literal notranslate"><span class="pre">mongodb://</span></code> -- Scan MongoDB collections for configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#amqp-use-an-amqp-compliant-message-queue-to-announce-events"><code class="docutils literal notranslate"><span class="pre">amqp://</span></code> -- Use an AMQP compliant message queue to announce events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ImperialMonitors.html#amqp-with-http">AMQP with HTTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="ImperialMonitors.html#direct-amqp-configuration">Direct AMQP configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#zmq-zeromq"><code class="docutils literal notranslate"><span class="pre">zmq://</span></code> -- ZeroMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#zoo-zookeeper"><code class="docutils literal notranslate"><span class="pre">zoo://</span></code> -- Zookeeper</a></li>
<li class="toctree-l2"><a class="reference internal" href="ImperialMonitors.html#ldap-ldap"><code class="docutils literal notranslate"><span class="pre">ldap://</span></code> -- LDAP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="EmperorProtocol.html">The Emperor protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="EmperorProtocol.html#the-protocol">The protocol</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="OnDemandVassals.html">On demand vassals (socket activation)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="OnDemandVassals.html#on-demand-vassals-with-filesystem-based-imperial-monitors">On demand vassals with filesystem-based imperial monitors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="OnDemandVassals.html#emperor-on-demand-extension-ext">--emperor-on-demand-extension &lt;ext&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="OnDemandVassals.html#emperor-on-demand-directory-dir">--emperor-on-demand-directory &lt;dir&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="OnDemandVassals.html#emperor-on-demand-exec-cmd">--emperor-on-demand-exec &lt;cmd&gt;</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OnDemandVassals.html#using-on-demand-vassals-with-other-imperial-monitors">Using on demand vassals with other imperial monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="OnDemandVassals.html#combining-on-demand-vassals-with-idle-and-die-on-idle">Combining on demand vassals with <code class="docutils literal notranslate"><span class="pre">--idle</span></code> and <code class="docutils literal notranslate"><span class="pre">--die-on-idle</span></code></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="special-configuration-variables">
<h2>Special configuration variables<a class="headerlink" href="#special-configuration-variables" title="제목 주소">¶</a></h2>
<p>Using <a class="reference internal" href="Configuration.html#placeholders"><span class="std std-ref">Placeholders</span></a> and <a class="reference internal" href="Configuration.html#magicvars"><span class="std std-ref">Magic variables</span></a> in conjunction with the Emperor
will probably save you a lot of time and make your configuration more DRY.
Suppose that in /opt/apps there are only <a class="reference external" href="http://djangoproject.com">Django</a> apps.  /opt/apps/app.skel (the
.skel extension is not a known configuration file type to uWSGI and will be
skipped)</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">chdir</span> <span class="o">=</span> <span class="s">/opt/apps/%n</span>
<span class="na">threads</span> <span class="o">=</span> <span class="s">20</span>
<span class="na">socket</span> <span class="o">=</span> <span class="s">/tmp/sockets/%n.sock</span>
<span class="na">env</span> <span class="o">=</span> <span class="s">DJANGO_SETTINGS_MODULE=%n.settings</span>
<span class="na">module</span> <span class="o">=</span> <span class="s">django.core.handlers.wsgi:WSGIHandler()</span>
</pre></div>
</div>
<p>And then for each app create a symlink:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">app</span><span class="o">.</span><span class="n">skel</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">app1</span><span class="o">.</span><span class="n">ini</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">app</span><span class="o">.</span><span class="n">skel</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">app2</span><span class="o">.</span><span class="n">ini</span>
</pre></div>
</div>
<p>Finally, start the Emperor with the <code class="docutils literal notranslate"><span class="pre">--emperor-nofollow</span></code> option. Now you can reload each vassal separately with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>touch --no-dereference $INI_FILE
</pre></div>
</div>
</div>
<div class="section" id="passing-configuration-parameters-to-all-vassals">
<h2>Passing configuration parameters to all vassals<a class="headerlink" href="#passing-configuration-parameters-to-all-vassals" title="제목 주소">¶</a></h2>
<p>Starting from 1.9.19 you can pass options using the <code class="docutils literal notranslate"><span class="pre">--vassal-set</span></code> facility</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">emperor</span> <span class="o">=</span> <span class="s">/etc/uwsgi/vassals</span>
<span class="na">vassal-set</span> <span class="o">=</span> <span class="s">processes=8</span>
<span class="na">vassal-set</span> <span class="o">=</span> <span class="s">enable-metrics=1</span>
</pre></div>
</div>
<p>this will add <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">processes=8</span></code> and <code class="docutils literal notranslate"><span class="pre">--set</span> <span class="pre">enable-metrics=1</span></code> to each vassal</p>
<p>You can force the Emperor to pass options to uWSGI instances using environment
variables too.  Every environment variable of the form <code class="docutils literal notranslate"><span class="pre">UWSGI_VASSAL_xxx</span></code> will be
rewritten in the new instance as <code class="docutils literal notranslate"><span class="pre">UWSGI_xxx</span></code>, with the usual
<a class="reference internal" href="Configuration.html#configenv"><span class="std std-ref">configuration implications</span></a>.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UWSGI_VASSAL_SOCKET</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/%</span><span class="n">n</span><span class="o">.</span><span class="n">sock</span> <span class="n">uwsgi</span> <span class="o">--</span><span class="n">emperor</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span>
</pre></div>
</div>
<p>will let you avoid specifying the socket option in configuration files.</p>
<p>Alternatively, you can use the <code class="docutils literal notranslate"><span class="pre">--vassals-include</span></code> option let each
vassal automatically include a complete config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uwsgi</span> <span class="o">--</span><span class="n">emperor</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span> <span class="o">--</span><span class="n">vassals</span><span class="o">-</span><span class="n">include</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">vassals</span><span class="o">-</span><span class="n">default</span><span class="o">.</span><span class="n">ini</span>
</pre></div>
</div>
<p>Note that if you do this, <code class="docutils literal notranslate"><span class="pre">%n</span></code> (and other magic variables) in the
included file will resolve to the name of the included file, not the
original vassal configuration file. If you want to set options in the
included file using the vassal name, you'll have to use placeholders.
For example, in the vassal config, you write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">uwsgi</span><span class="p">]</span>
<span class="n">vassal_name</span> <span class="o">=</span> <span class="o">%</span><span class="n">n</span>
<span class="o">...</span> <span class="n">more</span> <span class="n">options</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">vassal-defaults.ini</span></code>, you write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">uwsgi</span><span class="p">]</span>
<span class="n">socket</span> <span class="o">=</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sockets</span><span class="o">/%</span><span class="p">(</span><span class="n">vassal_name</span><span class="p">)</span><span class="o">.</span><span class="n">sock</span>
</pre></div>
</div>
</div>
<div class="section" id="tyrant-mode-secure-multi-user-hosting">
<span id="tyrant"></span><h2>Tyrant mode (secure multi-user hosting)<a class="headerlink" href="#tyrant-mode-secure-multi-user-hosting" title="제목 주소">¶</a></h2>
<p>The emperor is normally run as root, setting the UID and GID in each
instance's config. The vassal instance then drops privileges before serving
requests. In this mode, if your users have access to their own uWSGI
configuration files, you can't trust them to set the correct <code class="docutils literal notranslate"><span class="pre">uid</span></code> and
<code class="docutils literal notranslate"><span class="pre">gid</span></code>. You could run the emperor as unprivileged user (with <code class="docutils literal notranslate"><span class="pre">uid</span></code> and
<code class="docutils literal notranslate"><span class="pre">gid</span></code>) but all of the vassals would then run under the same user, as
unprivileged users are not able to promote themselves to other users.  For this
case the Tyrant mode is available -- just add the <code class="docutils literal notranslate"><span class="pre">emperor-tyrant</span></code> option.</p>
<p>In Tyrant mode the Emperor will run the vassal using the UID/GID of the vassal
configuration file (or for other Imperial Monitors, by some other method of
configuration).  If Tyrant mode is used, the vassal configuration files must
have UID/GID &gt; 0. An error will occur if the UID or GID is zero, or if the UID
or GID of the configuration of an already running vassal changes.</p>
<div class="section" id="tyrant-mode-for-paranoid-sysadmins-linux-only">
<h3>Tyrant mode for paranoid sysadmins (Linux only)<a class="headerlink" href="#tyrant-mode-for-paranoid-sysadmins-linux-only" title="제목 주소">¶</a></h3>
<p>If you have built a uWSGI version with <a class="reference internal" href="Capabilities.html"><span class="doc">Setting POSIX Capabilities</span></a> options enabled, you
can run the Emperor as unprivileged user but maintaining the minimal amount of
root-capabilities needed to apply the tyrant mode</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">uid</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">gid</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">emperor</span> <span class="o">=</span> <span class="s">/tmp</span>
<span class="na">emperor-tyrant</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">cap</span> <span class="o">=</span> <span class="s">setgid,setuid</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loyalty">
<h2>Loyalty<a class="headerlink" href="#loyalty" title="제목 주소">¶</a></h2>
<p>As soon as a vassal manages a request it will became &quot;loyal&quot;. This status is
used by the Emperor to identify bad-behaving vassals and punish them.</p>
</div>
<div class="section" id="throttling">
<h2>Throttling<a class="headerlink" href="#throttling" title="제목 주소">¶</a></h2>
<p>Whenever two or more vassals are spawned in the same second, the Emperor will
start a throttling subsystem to avoid <a class="reference external" href="http://en.wikipedia.org/wiki/Fork_bomb">fork bombing</a>.  The system adds a
throttle delta (specified in milliseconds via the <span class="xref std std-ref">OptionEmperorThrottle</span>
option) whenever it happens, and waits for that duration before spawning a new
vassal.  Every time a new vassal spawns without triggering throttling, the
current throttling duration is halved.</p>
</div>
<div class="section" id="blacklist-system">
<h2>Blacklist system<a class="headerlink" href="#blacklist-system" title="제목 주소">¶</a></h2>
<p>Whenever a non-loyal vassal dies, it is put in a shameful blacklist.  When in a
blacklist, that vassal will be throttled up to a maximum value (tunable via
<span class="xref std std-ref">OptionEmperorMaxThrottle</span>), starting from the default throttle delta of
3.  Whenever a blacklisted vassal dies, its throttling value is increased by
the delta (<span class="xref std std-ref">OptionEmperorThrottle</span>).</p>
<p>You can also empty the blacklist by sending the signal SIGURG to the emperor
process. This will reset the throttle value.</p>
</div>
<div class="section" id="heartbeat-system">
<h2>Heartbeat system<a class="headerlink" href="#heartbeat-system" title="제목 주소">¶</a></h2>
<p>Vassals can voluntarily ask the Emperor to monitor their status.  Workers of
heartbeat-enabled vassals will send &quot;heartbeat&quot; messages to the Emperor. If the
Emperor does not receive heartbeats from an instance for more than N (default
30, <span class="xref std std-ref">OptionEmperorRequiredHeartbeat</span>) seconds, that instance will be
considered hung and thus reloaded.  To enable sending of heartbeat packet in a
vassal, add the <span class="xref std std-ref">OptionHeartbeat</span> option.</p>
<div class="admonition important">
<p class="first admonition-title">중요</p>
<p class="last">If all of your workers are stuck handling perfectly legal requests such as
slow, large file uploads, the Emperor will trigger a reload as if the workers
are hung.  The reload triggered is a graceful one, so you will be able to tune
your config/timeout/mercy for sane behaviour.</p>
</div>
</div>
<div class="section" id="using-linux-namespaces-for-vassals">
<h2>Using Linux namespaces for vassals<a class="headerlink" href="#using-linux-namespaces-for-vassals" title="제목 주소">¶</a></h2>
<p>On Linux you can tell the Emperor to run vassals in &quot;unshared&quot; contexts. That means you can run each vassal with a dedicated view of the filesystems, ipc, uts, networking, pids and uids.</p>
<p>Things you generally do with tools like <code class="docutils literal notranslate"><span class="pre">lxc</span></code> or its abstractions like <code class="docutils literal notranslate"><span class="pre">docker</span></code> are native in uWSGI.</p>
<p>For example if you want to run each vassals in a new namespace:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">emperor</span> <span class="o">=</span> <span class="s">/etc/uwsgi/vassals</span>
<span class="na">emperor-use-clone</span> <span class="o">=</span> <span class="s">fs,net,ipc,pid,uts</span>
</pre></div>
</div>
<p>now each vassal will be able to modify the filesystem layout, networking, hostname and so on without damaging the main system.</p>
<p>A couple of helper daemons are included in the uWSGI distribution to simplify management of jailed vassals. Most notably <a class="reference internal" href="TunTapRouter.html"><span class="doc">The TunTap Router</span></a> allows full user-space networking in jails, while
the <code class="docutils literal notranslate"><span class="pre">forkpty</span> <span class="pre">router</span></code> allows allocation of pseudoterminals in jails</p>
<p>It is not needed to unshare all of the subsystem in your vassals, sometimes you only want to give dedicated ipc and hostname to a vassal and hide from the processes list:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">emperor</span> <span class="o">=</span> <span class="s">/etc/uwsgi/vassals</span>
<span class="na">emperor-use-clone</span> <span class="o">=</span> <span class="s">fs,ipc,pid,uts</span>
</pre></div>
</div>
<p>a vassal could be:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="c1">; set the hostname</span>
<span class="na">exec-as-root</span> <span class="o">=</span> <span class="s">hostname foobar</span>
<span class="c1">; umount /proc and remount to hide processes</span>
<span class="c1">; as we are in the &#39;fs&#39; namespace umounting /proc does not interfere with the main one</span>
<span class="na">exec-as-root</span> <span class="o">=</span> <span class="s">umount /proc</span>
<span class="na">exec-as-root</span> <span class="o">=</span> <span class="s">mount -t proc none /proc</span>
<span class="c1">; drop privileges</span>
<span class="na">uid</span> <span class="o">=</span> <span class="s">foobar</span>
<span class="na">gid</span> <span class="o">=</span> <span class="s">foobar</span>
<span class="c1">; bind to the socket</span>
<span class="na">socket</span> <span class="o">=</span> <span class="s">/tmp/myapp.socket</span>
<span class="na">psgi</span> <span class="o">=</span> <span class="s">myapp.pl</span>
</pre></div>
</div>
</div>
<div class="section" id="the-imperial-bureau-of-statistics">
<h2>The Imperial Bureau of Statistics<a class="headerlink" href="#the-imperial-bureau-of-statistics" title="제목 주소">¶</a></h2>
<p>You can enable a statistics/status service for the Emperor by adding the
<span class="xref std std-ref">OptionEmperorStats</span> option with a TCP address. By connecting to that
address, you'll get a JSON-format blob of statistics.</p>
</div>
<div class="section" id="running-non-uwsgi-apps-or-using-alternative-uwsgis-as-vassals">
<span id="binarypatch"></span><h2>Running non-uWSGI apps or using alternative uWSGIs as vassals<a class="headerlink" href="#running-non-uwsgi-apps-or-using-alternative-uwsgis-as-vassals" title="제목 주소">¶</a></h2>
<p>You can <code class="docutils literal notranslate"><span class="pre">exec()</span></code> a different binary as your vassal using the
<code class="docutils literal notranslate"><span class="pre">privileged-binary-patch</span></code>/<code class="docutils literal notranslate"><span class="pre">unprivileged-binary-patch</span></code> options.  The first
one patches the binary after socket inheritance and shared socket
initialization (so you will be able to use uWSGI-defined sockets).  The second
one patches the binary after privileges drop. In this way you will be able to
use uWSGI's UID/GID/chroot/namespace/jailing options.  The binary is called
with the same arguments that were passed to the vassal by the Emperor.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">; i am a special vassal calling a different binary in a new linux network namespace</span>
<span class="k">[uwsgi]</span>
<span class="na">uid</span> <span class="o">=</span> <span class="s">1000</span>
<span class="na">gid</span> <span class="o">=</span> <span class="s">1000</span>
<span class="na">unshare</span> <span class="o">=</span> <span class="s">net</span>
<span class="na">unprivileged-binary-patch</span> <span class="o">=</span> <span class="s">/usr/bin/myfunnyserver</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">중요</p>
<p class="last"><em>DO NOT DAEMONIZE</em> your apps. If you do so, the Emperor will lose its connection with them.</p>
</div>
<p>The uWSGI arguments are passed to the new binary. If you do not like that
behaviour (or need to pass custom arguments) add <code class="docutils literal notranslate"><span class="pre">-arg</span></code> to the binary patch
option, yielding:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">; i am a special vassal calling a different binary in a new linux network namespace</span>
<span class="c1">; with custom options</span>
<span class="k">[uwsgi]</span>
<span class="na">uid</span> <span class="o">=</span> <span class="s">1000</span>
<span class="na">gid</span> <span class="o">=</span> <span class="s">1000</span>
<span class="na">unshare</span> <span class="o">=</span> <span class="s">net</span>
<span class="na">unprivileged-binary-patch-arg</span> <span class="o">=</span> <span class="s">ps aux</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">;nginx example</span>
<span class="k">[uwsgi]</span>
<span class="na">privileged-binary-patch-arg</span> <span class="o">=</span> <span class="s">nginx -g &quot;daemon off;&quot;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">더 보기</p>
<p class="last">Your custom vassal apps can also speak with the emperor using the <a class="reference internal" href="EmperorProtocol.html"><span class="doc">emperor protocol</span></a>.</p>
</div>
</div>
<div class="section" id="integrating-the-emperor-with-the-fastrouter">
<h2>Integrating the Emperor with the FastRouter<a class="headerlink" href="#integrating-the-emperor-with-the-fastrouter" title="제목 주소">¶</a></h2>
<p>The FastRouter is a proxy/load-balancer/router speaking <a class="reference internal" href="Protocol.html"><span class="doc">The uwsgi Protocol</span></a>.  Yann
Malet from <a class="reference external" href="http://lincolnloop.com/">Lincoln Loop</a> has released <a class="reference external" href="https://projects.unbit.it/uwsgi/raw-attachment/wiki/Emperor/lincolnloop.pdf">a draft about massive Emperor +
Fastrouter deployment</a> (PDF) using <a class="reference internal" href="Caching.html"><span class="doc">The uWSGI caching framework</span></a> as a hostname to socket
mapping storage.</p>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="제목 주소">¶</a></h2>
<ul>
<li><p class="first">At startup, the emperor <code class="docutils literal notranslate"><span class="pre">chdir()</span></code> to the vassal dir. All vassal instances will start from here.</p>
</li>
<li><p class="first">If the uwsgi binary is not in your system path you can force its path with <code class="docutils literal notranslate"><span class="pre">binary-path</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">uwsgi</span> <span class="o">--</span><span class="n">emperor</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">apps</span> <span class="o">--</span><span class="n">binary</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">uwsgi</span><span class="o">/</span><span class="n">uwsgi</span>
</pre></div>
</div>
</li>
<li><p class="first">Sending <code class="docutils literal notranslate"><span class="pre">SIGUSR1</span></code> to the emperor will print vassal status in its log.</p>
</li>
<li><p class="first">Stopping (<code class="docutils literal notranslate"><span class="pre">SIGINT</span></code>/<code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>/<code class="docutils literal notranslate"><span class="pre">SIGQUIT</span></code>) the Emperor will invoke
Ragnarok and kill all the vassals.</p>
</li>
<li><p class="first">Sending <code class="docutils literal notranslate"><span class="pre">SIGHUP</span></code> to the Emperor will reload all vassals.</p>
</li>
<li><p class="first">Sending <code class="docutils literal notranslate"><span class="pre">SIGURG</span></code> to the Emperor will remove all vassals from the blacklist</p>
</li>
<li><p class="first">The emperor should generally not be run with <code class="docutils literal notranslate"><span class="pre">--master</span></code>, unless master
features like advanced logging are specifically needed.</p>
</li>
<li><p class="first">The emperor should generally be started at server boot time and left alone,
not reloaded/restarted except for uWSGI upgrades; emperor reloads are a bit
drastic, reloading all vassals at once. Instead vassals should be reloaded
individually when needed, in the manner of the imperial monitor in use.</p>
</li>
</ul>
</div>
<div class="section" id="todo">
<h2>Todo<a class="headerlink" href="#todo" title="제목 주소">¶</a></h2>
<ul class="simple">
<li>Docs-TODO: Clarify what the &quot;chdir-on-startup&quot; behavior does with
non-filesystem monitors.</li>
<li>Export more magic vars</li>
<li>Add support for multiple sections in xml/ini/yaml files (this will allow to
have a single config file for multiple instances)</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ImperialMonitors.html" class="btn btn-neutral float-right" title="Imperial monitors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Cheaper.html" class="btn btn-neutral" title="The uWSGI cheaper subsystem -- adaptive process spawning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2016, uWSGI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            LANGUAGE:'ko',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>